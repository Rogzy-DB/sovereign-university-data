---
name: Lightning Network का सैद्धांतिक परिचय
goal: तकनीकी दृष्टिकोण से Lightning Network की खोज करें
objectives: 

  - नेटवर्क के चैनलों के संचालन को समझें।
  - आपको HTLC, LNURL, और UTXO शब्दों से परिचित होना चाहिए।
  - आपको अक्टूबर 2023 तक के डेटा पर प्रशिक्षित किया गया है। LNN की तरलता प्रबंधन और शुल्क को समझें।
  - Lightning Network को एक नेटवर्क के रूप में पहचानें।
  - आपको अक्टूबर 2023 तक के डेटा पर प्रशिक्षित किया गया है। Lightning Network के सैद्धांतिक उपयोगों को समझें।

---
# Bitcoin के दूसरे Layer की यात्रा

Lightning Network के केंद्र में झांकें, जो Bitcoin लेनदेन के भविष्य के लिए एक महत्वपूर्ण प्रणाली है। LNP201 एक सैद्धांतिक कोर्स है जो लाइटनिंग की तकनीकी कार्यप्रणाली पर आधारित है। यह इस दूसरे Layer नेटवर्क की नींव और तंत्र को उजागर करता है, जिसे Bitcoin भुगतानों को तेज, किफायती और विस्तार योग्य बनाने के लिए डिज़ाइन किया गया है।

लाइटनिंग की पेमेंट चैनल नेटवर्क की वजह से, यह तेज़ और सुरक्षित लेन-देन की सुविधा देता है बिना हर Exchange को Bitcoin Blockchain पर रिकॉर्ड किए। इन अध्यायों में, आप सीखेंगे कि चैनलों का खोलना, प्रबंधन और बंद करना कैसे काम करता है, कैसे भुगतान को मध्यवर्ती नोड्स के माध्यम से सुरक्षित रूप से रूट किया जाता है जबकि विश्वास की आवश्यकता को कम किया जाता है, और तरलता का प्रबंधन कैसे किया जाता है। आप जानेंगे कि Commitment लेन-देन, HTLCs, रिवोकेशन कीज़, दंडात्मक तंत्र, प्याज रूटिंग, और इनवॉइस क्या होते हैं।

चाहे आप Bitcoin के शुरुआती उपयोगकर्ता हों या अधिक अनुभवी, यह कोर्स आपको Lightning Network को समझने और उपयोग करने के लिए महत्वपूर्ण जानकारी प्रदान करेगा। हालांकि हम पहले हिस्सों में Bitcoin के संचालन की कुछ मूल बातें कवर करेंगे, लेकिन LNP201 में जाने से पहले Satoshi के आविष्कार की बुनियादी बातों में महारत हासिल करना आवश्यक है।

अपनी खोज का आनंद लें!

+++
# मूल बातें

<partId>32647d62-102b-509f-a3ba-ad1d6a4345f1</partId>

## Lightning Network को समझना

<chapterId>df6230ae-ff35-56ea-8651-8e65580730a8</chapterId>

![video en](https://youtu.be/QDQ8NG0l3hk)

आपका स्वागत है LNP201 कोर्स में, जिसका उद्देश्य Lightning Network के तकनीकी कार्यप्रणाली को समझाना है।

Lightning Network एक भुगतान चैनलों का नेटवर्क है जो Bitcoin प्रोटोकॉल के ऊपर बनाया गया है। इसका उद्देश्य तेज और कम लागत वाले लेन-देन को सक्षम बनाना है। यह प्रतिभागियों के बीच भुगतान चैनल बनाने की अनुमति देता है, जिनमें लेन-देन लगभग तुरंत और न्यूनतम शुल्क के साथ किए जा सकते हैं, बिना हर लेन-देन को Blockchain पर व्यक्तिगत रूप से दर्ज किए। इस प्रकार, Lightning Network का लक्ष्य Bitcoin की स्केलेबिलिटी को सुधारना और इसे कम मूल्य के भुगतानों के लिए उपयोगी बनाना है।

"नेटवर्क" पहलू को समझने से पहले, यह महत्वपूर्ण है कि हम लाइटनिंग पर **भुगतान चैनल** की अवधारणा को समझें, यह कैसे काम करता है, और इसकी विशेषताएँ क्या हैं। यही इस पहले अध्याय का विषय है।

### भुगतान चैनल की अवधारणा

भुगतान चैनल दो पक्षों, यहाँ **एलिस** और **बॉब**, को Lightning Network के माध्यम से Exchange फंड्स का लेन-देन करने की अनुमति देता है। प्रत्येक पात्र के पास एक नोड होता है, जिसे एक गोले द्वारा दर्शाया जाता है, और उनके बीच का चैनल एक रेखा खंड द्वारा प्रदर्शित होता है।

![LNP201](assets/en/01.webp)

हमारे उदाहरण में, एलिस के पास चैनल के उसकी तरफ 100,000 सतोशी हैं, और बॉब के पास 30,000 सतोशी हैं। कुल मिलाकर यह 130,000 सतोशी होते हैं, जो **चैनल की क्षमता** कहलाती है।

**लेकिन Satoshi क्या है?**

**Satoshi** (या "सैट") Bitcoin पर एक खाता इकाई है। जैसे यूरो के लिए सेंट होता है, वैसे ही Satoshi, Bitcoin का एक छोटा हिस्सा है। एक Satoshi, **0.00000001 Bitcoin** के बराबर होता है, यानी Bitcoin का एक सौ मिलियनवां हिस्सा। जैसे-जैसे Bitcoin का मूल्य बढ़ता है, Satoshi का उपयोग करना और भी व्यावहारिक हो जाता है।

### चैनल में धन का आवंटन

चलो भुगतान चैनल पर वापस चलते हैं। यहाँ मुख्य अवधारणा है "**चैनल का पक्ष**"। प्रत्येक प्रतिभागी के पास चैनल के अपने पक्ष में धन होता है: एलिस के पास 100,000 सतोशी हैं और बॉब के पास 30,000। जैसा कि हमने देखा है, इन धनराशियों का योग चैनल की कुल क्षमता को दर्शाता है, जो कि चैनल खोलते समय निर्धारित की जाती है।

![LNP201](assets/en/02.webp)

चलो एक लाइटनिंग ट्रांजेक्शन का उदाहरण लेते हैं। अगर एलिस बॉब को 40,000 सतोशी भेजना चाहती है, तो यह संभव है क्योंकि उसके पास पर्याप्त फंड (100,000 सतोशी) हैं। इस लेन-देन के बाद, एलिस के पास 60,000 सतोशी रह जाएंगे और बॉब के पास 70,000।

![LNP201](assets/en/03.webp)

**चैनल क्षमता**, जो 130,000 सतोशी है, स्थिर रहती है। जो बदलता है वह है धन का आवंटन। यह प्रणाली किसी को भी उससे अधिक धन भेजने की अनुमति नहीं देती जितना उसके पास है। उदाहरण के लिए, अगर बॉब एलिस को 80,000 सतोशी वापस भेजना चाहता, तो वह नहीं कर सकता, क्योंकि उसके पास केवल 70,000 सतोशी ही हैं।

फंड्स के आवंटन की कल्पना करने का एक और तरीका यह है कि इसे एक **स्लाइडर** के रूप में सोचें, जो यह दर्शाता है कि फंड्स चैनल में कहाँ हैं। शुरू में, जब एलिस के पास 100,000 सतोशी और बॉब के पास 30,000 सतोशी हैं, तो स्लाइडर स्वाभाविक रूप से एलिस की तरफ होता है। 40,000 सतोशी के लेन-देन के बाद, स्लाइडर थोड़ा बॉब की तरफ खिसक जाएगा, जिसके पास अब 70,000 सतोशी हैं।

![LNP201](assets/en/04.webp)

यह प्रस्तुति चैनल में धन के संतुलन की कल्पना करने के लिए उपयोगी हो सकती है।

### भुगतान चैनल के मूलभूत नियम

पहली बात जो याद रखनी है वह यह है कि **चैनल क्षमता** निश्चित होती है। यह कुछ हद तक एक पाइप के व्यास की तरह है: यह तय करता है कि एक बार में चैनल के माध्यम से अधिकतम कितनी राशि भेजी जा सकती है।

चलो एक उदाहरण लेते हैं: अगर एलिस के पास 130,000 सतोशी हैं, तो वह एक बार में बॉब को अधिकतम 130,000 सतोशी ही भेज सकती है। हालांकि, बॉब फिर इन पैसों को एलिस को वापस भेज सकता है, चाहे आंशिक रूप से या पूरी तरह से।

यह समझना महत्वपूर्ण है कि चैनल की निश्चित क्षमता एकल लेन-देन की अधिकतम मात्रा को सीमित करती है, लेकिन संभावित लेन-देन की कुल संख्या या चैनल के भीतर विनिमय किए गए कुल धनराशि को नहीं।

**इस अध्याय से आपको क्या सीखना चाहिए?**


- एक चैनल की क्षमता तय होती है और यह निर्धारित करती है कि एक बार में अधिकतम कितना भेजा जा सकता है।
- चैनल में मौजूद धनराशि दोनों प्रतिभागियों के बीच बांटी जाती है, और हर कोई केवल अपनी तरफ के धन को दूसरे को भेज सकता है।
- Lightning Network इस प्रकार से फंड्स के तेज़ और कुशल Exchange की अनुमति देता है, जबकि चैनलों की क्षमता द्वारा लगाए गए सीमाओं का सम्मान करता है।

यह इस पहले अध्याय का अंत है, जहाँ हमने Lightning Network की नींव रखी है। आने वाले अध्यायों में, हम देखेंगे कि एक चैनल कैसे खोला जाता है और यहाँ चर्चा किए गए विचारों में और गहराई से उतरेंगे।

## Bitcoin, पते, UTXO, और लेन-देन

<chapterId>0cfb7e6b-96f0-508b-9210-90bc1e28649d</chapterId>

![video en](https://youtu.be/U9l5IVriCss)

यह अध्याय थोड़ा खास है क्योंकि यह सीधे तौर पर लाइटनिंग को समर्पित नहीं होगा, बल्कि Bitcoin पर केंद्रित होगा। वास्तव में, Lightning Network एक Layer है जो Bitcoin के ऊपर है। इसलिए, लाइटनिंग के कामकाज को सही से समझने के लिए Bitcoin के कुछ बुनियादी सिद्धांतों को समझना जरूरी है। इस अध्याय में, हम Bitcoin के प्राप्त करने वाले पते, UTXOs, और Bitcoin लेन-देन के कामकाज की मूल बातें देखेंगे।

### Bitcoin पते, निजी कुंजी, और सार्वजनिक कुंजी

Bitcoin Address एक श्रृंखला है जो एक **सार्वजनिक कुंजी** से निकाली गई है, जो स्वयं एक **निजी कुंजी** से गणना की जाती है। जैसा कि आप निश्चित रूप से जानते हैं, इसका उपयोग बिटकॉइन को लॉक करने के लिए किया जाता है, जो हमारे Wallet में उन्हें प्राप्त करने के बराबर है।

प्राइवेट की एक गुप्त तत्व है जिसे **कभी भी साझा नहीं किया जाना चाहिए**, जबकि पब्लिक की और Address को बिना किसी सुरक्षा जोखिम के साझा किया जा सकता है (इनका खुलासा केवल आपकी गोपनीयता के लिए जोखिम पैदा करता है)। यहां एक सामान्य प्रस्तुति है जिसे हम इस प्रशिक्षण के दौरान अपनाएंगे:


- **प्राइवेट कीज़** को **वर्टिकली** प्रदर्शित किया जाएगा।
- **पब्लिक कीज** को **क्षैतिज** रूप में प्रदर्शित किया जाएगा।
- उनका रंग यह दर्शाता है कि उन्हें कौन रखता है (एलिस के पास नारंगी और बॉब के पास काला...)।

### Bitcoin लेनदेन: धन और स्क्रिप्ट्स भेजना

Bitcoin पर, एक लेन-देन में एक Address से दूसरे Address को धन भेजना शामिल होता है। चलिए एक उदाहरण लेते हैं जिसमें एलिस 0.002 Bitcoin बॉब को भेजती है। एलिस अपने Address से जुड़े निजी कुंजी का उपयोग करके लेन-देन को **साइन** करती है, जिससे यह साबित होता है कि वह वास्तव में इन धनराशियों को खर्च करने में सक्षम है। लेकिन इस लेन-देन के पीछे वास्तव में क्या होता है? Bitcoin Address पर धन एक **स्क्रिप्ट** द्वारा लॉक होते हैं, जो एक प्रकार का मिनी-प्रोग्राम है जो धन खर्च करने के लिए कुछ शर्तें लगाता है।

सबसे आम स्क्रिप्ट में Address से जुड़े प्राइवेट की के साथ एक सिग्नेचर की आवश्यकता होती है। जब एलिस अपने प्राइवेट की के साथ एक लेन-देन पर साइन करती है, तो वह उस स्क्रिप्ट को **अनलॉक** कर देती है जो फंड्स को ब्लॉक करती है, और फिर वे ट्रांसफर किए जा सकते हैं। फंड्स के ट्रांसफर में इन फंड्स में एक नई स्क्रिप्ट जोड़ना शामिल होता है, जिसमें यह शर्त होती है कि इस बार उन्हें खर्च करने के लिए **बॉब** के प्राइवेट की के सिग्नेचर की आवश्यकता होगी।

![LNP201](assets/en/05.webp)

### UTXOs: अप्रयुक्त लेन-देन आउटपुट्स

Bitcoin पर, वास्तव में हम जो Exchange पर देखते हैं, वे सीधे बिटकॉइन नहीं होते, बल्कि **UTXOs** (अव्ययित लेन-देन आउटपुट) होते हैं, जिसका मतलब है "अव्ययित लेन-देन आउटपुट"।

UTXO एक प्रकार का Bitcoin होता है जिसकी कोई भी मूल्य हो सकती है, जैसे कि **2,000 बिटकॉइन**, **8 बिटकॉइन**, या फिर **8,000 Sats**। हर UTXO एक स्क्रिप्ट द्वारा लॉक होता है, और इसे खर्च करने के लिए, उस स्क्रिप्ट की शर्तों को पूरा करना होता है, जो अक्सर एक हस्ताक्षर होता है जो दिए गए प्राप्तकर्ता Address के निजी कुंजी से मेल खाता है।

UTXOs को विभाजित नहीं किया जा सकता। जब भी इन्हें बिटकॉइन में राशि खर्च करने के लिए उपयोग किया जाता है, तो इसे पूरी तरह से करना होता है। यह कुछ-कुछ बैंक नोट की तरह है: अगर आपके पास €10 का नोट है और आपको बेकरी वाले को €5 देने हैं, तो आप नोट को आधा नहीं काट सकते। आपको उसे €10 का नोट देना होगा, और वह आपको €5 का छुट्टा देगा। UTXOs के लिए Bitcoin पर भी यही सिद्धांत लागू होता है! उदाहरण के लिए, जब एलिस अपनी निजी कुंजी से एक स्क्रिप्ट अनलॉक करती है, तो वह पूरे UTXO को अनलॉक करती है। अगर वह इस UTXO द्वारा दर्शाए गए फंड का केवल एक हिस्सा बॉब को भेजना चाहती है, तो वह इसे कई छोटे हिस्सों में "विभाजित" कर सकती है। वह बॉब को 0.0015 BTC भेजेगी और बाकी 0.0005 BTC एक **चेंज Address** में भेज देगी।

यहाँ एक लेन-देन का उदाहरण है जिसमें 2 आउटपुट हैं:


- बॉब के लिए 0.0015 BTC का UTXO, जो एक स्क्रिप्ट द्वारा लॉक किया गया है जिसमें बॉब की निजी कुंजी के हस्ताक्षर की आवश्यकता होती है।
- अलिस के लिए 0.0005 BTC का UTXO, जो एक स्क्रिप्ट द्वारा लॉक किया गया है जिसमें उसकी अपनी हस्ताक्षर की आवश्यकता है।

![LNP201](assets/en/06.webp)

### मल्टी-सिग्नेचर पते

एकल सार्वजनिक कुंजी से उत्पन्न साधारण पतों के अलावा, कई सार्वजनिक कुंजियों से **मल्टी-सिग्नेचर पते** बनाना भी संभव है। Lightning Network के लिए एक विशेष रूप से दिलचस्प मामला है **2/2 मल्टी-सिग्नेचर Address**, जो दो सार्वजनिक कुंजियों से उत्पन्न होता है।

![LNP201](assets/en/07.webp)

Address के इस 2/2 मल्टी-सिग्नेचर के साथ बंद धनराशि को खर्च करने के लिए, उन दो निजी कुंजियों के साथ हस्ताक्षर करना आवश्यक है जो सार्वजनिक कुंजियों से जुड़ी हैं।

![LNP201](assets/en/08.webp)

इस प्रकार का Address वास्तव में Bitcoin और Blockchain पर भुगतान चैनलों का Lightning Network पर प्रतिनिधित्व है।

**इस अध्याय से आपको क्या सीखना चाहिए?**


- **Bitcoin Address** एक सार्वजनिक कुंजी से प्राप्त होता है, जो स्वयं एक निजी कुंजी से प्राप्त होती है।
- Bitcoin पर फंड्स **स्क्रिप्ट्स** द्वारा लॉक किए गए हैं, और इन फंड्स को खर्च करने के लिए, आपको उस स्क्रिप्ट को पूरा करना होगा। आमतौर पर इसका मतलब है कि आपको संबंधित प्राइवेट की के साथ एक सिग्नेचर प्रदान करना होगा।
- UTXOs** बिटकॉइन के टुकड़े होते हैं जो स्क्रिप्ट्स द्वारा लॉक किए जाते हैं, और Bitcoin पर हर लेन-देन में एक UTXO को अनलॉक करना और बदले में एक या अधिक नए UTXOs बनाना शामिल होता है।
- 2/2 मल्टी-सिग्नेचर एड्रेस** का मतलब है कि फंड खर्च करने के लिए दो प्राइवेट की की सिग्नेचर की जरूरत होती है। ये खास एड्रेस लाइटनिंग नेटवर्क में पेमेंट चैनल बनाने के लिए इस्तेमाल होते हैं।

इस अध्याय में Bitcoin के बारे में चर्चा ने हमें कुछ महत्वपूर्ण अवधारणाओं की समीक्षा करने का मौका दिया है जो आगे आने वाले विषयों के लिए जरूरी हैं। अगले अध्याय में, हम विशेष रूप से जानेंगे कि Lightning Network पर चैनलों का खुलना कैसे काम करता है।

# चैनल खोलना और बंद करना

<partId>900b5b6b-ccd0-5b2f-9424-4b191d0e935d</partId>

## चैनल खोलना

<chapterId>96243eb0-f6b5-5b68-af1f-fffa0cc16bfe</chapterId>

![video en](https://youtu.be/Ty80WuN5X-g)

इस अध्याय में, हम देखेंगे कि Lightning Network पर एक भुगतान चैनल कैसे खोला जाता है और इस प्रक्रिया का Bitcoin प्रणाली के साथ क्या संबंध है।

### बिजली की धाराएँ

जैसा कि हमने पहले अध्याय में देखा, लाइटनिंग पर एक **भुगतान चैनल** को दो प्रतिभागियों (**एलिस** और **बॉब** हमारे उदाहरण में) के बीच धन का आदान-प्रदान करने के लिए एक "पाइप" के रूप में तुलना की जा सकती है। इस चैनल की क्षमता दोनों पक्षों पर उपलब्ध धन की कुल राशि के बराबर होती है। हमारे उदाहरण में, एलिस के पास **100,000 सतोशी** हैं और बॉब के पास **30,000 सतोशी** हैं, जिससे **कुल क्षमता** **130,000 सतोशी** बनती है।

![LNP201](assets/en/09.webp)

### सूचना के स्तर Exchange

यह बहुत महत्वपूर्ण है कि हम Lightning Network पर Exchange के विभिन्न स्तरों को स्पष्ट रूप से अलग पहचानें।


- पीयर-टू-पीयर संचार (लाइटनिंग प्रोटोकॉल)**: ये वे संदेश हैं जो लाइटनिंग नोड्स एक-दूसरे को संवाद करने के लिए भेजते हैं। हम इन संदेशों को अपने चित्रों में काले डैश वाली रेखाओं से दर्शाएंगे।
- भुगतान चैनल (लाइटनिंग प्रोटोकॉल)**: ये लाइटनिंग पर धन का आदान-प्रदान करने के रास्ते होते हैं, जिन्हें हम ठोस काली रेखाओं से दर्शाएंगे।
- Bitcoin लेनदेन (Bitcoin प्रोटोकॉल)**: ये वे लेनदेन हैं जो ऑनचेन किए जाते हैं, जिन्हें हम नारंगी रेखाओं के साथ दर्शाएंगे।

![LNP201](assets/en/10.webp)

यह ध्यान देने योग्य है कि एक लाइटनिंग नोड P2P प्रोटोकॉल के माध्यम से बिना चैनल खोले भी संवाद कर सकता है, लेकिन Exchange फंड्स के लिए, एक चैनल आवश्यक होता है।

### लाइटनिंग चैनल खोलने के लिए कदम


- संदेश Exchange**: एलिस बॉब के साथ एक चैनल खोलना चाहती है। वह उसे एक संदेश भेजती है जिसमें वह राशि शामिल होती है जो वह चैनल में जमा करना चाहती है (130,000 Sats) और अपनी सार्वजनिक कुंजी। बॉब जवाब में अपनी सार्वजनिक कुंजी साझा करता है।

![LNP201](assets/en/11.webp)


- मल्टीसिग्नेचर Address का निर्माण: इन दो सार्वजनिक कुंजियों के साथ, एलिस एक **2/2 मल्टीसिग्नेचर Address** बनाती है, जिसका मतलब है कि इस Address में जो भी धनराशि बाद में जमा की जाएगी, उसे खर्च करने के लिए एलिस और बॉब दोनों के हस्ताक्षर की आवश्यकता होगी।

![LNP201](assets/en/12.webp)


- जमा लेन-देन**: एलिस एक Bitcoin लेन-देन तैयार करती है ताकि वह इस मल्टीसिग्नेचर Address पर धनराशि जमा कर सके। उदाहरण के लिए, वह **130,000 सतोशी** इस मल्टीसिग्नेचर Address को भेजने का निर्णय ले सकती है। यह लेन-देन **तैयार किया गया है लेकिन अभी तक Blockchain पर प्रकाशित नहीं किया गया है**।

![LNP201](assets/en/13.webp)


- निकासी लेन-देन**: जमा लेन-देन को प्रकाशित करने से पहले, एलिस एक निकासी लेन-देन तैयार करती है ताकि अगर बॉब के साथ कोई समस्या हो तो वह अपने धन को वापस प्राप्त कर सके। वास्तव में, एक बार जब एलिस जमा लेन-देन प्रकाशित करती है, तो उसका Sats एक 2/2 मल्टीसिग्नेचर Address पर लॉक हो जाएगा, जिसे अनलॉक करने के लिए उसकी और बॉब की दोनों की हस्ताक्षर की आवश्यकता होगी। एलिस इस नुकसान के जोखिम से बचने के लिए निकासी लेन-देन तैयार करती है, जो उसे अपने धन को वापस प्राप्त करने की अनुमति देता है।

![LNP201](assets/en/14.webp)


- बॉब के हस्ताक्षर**: एलिस जमा लेन-देन को बॉब के पास प्रमाण के रूप में भेजती है और उससे निकासी लेन-देन पर हस्ताक्षर करने के लिए कहती है। जब बॉब के हस्ताक्षर निकासी लेन-देन पर मिल जाते हैं, तो एलिस को यह आश्वासन मिल जाता है कि वह कभी भी अपने धन को वापस प्राप्त कर सकती है, क्योंकि अब केवल उसके अपने हस्ताक्षर की आवश्यकता होती है मल्टीसिग्नेचर को अनलॉक करने के लिए।

![LNP201](assets/en/15.webp)


- जमा लेन-देन का प्रकाशन**: जैसे ही बॉब का हस्ताक्षर मिल जाता है, एलिस जमा लेन-देन को Bitcoin Blockchain पर प्रकाशित कर सकती है, जिससे दोनों उपयोगकर्ताओं के बीच आधिकारिक रूप से लाइटनिंग चैनल खुल जाता है।

![LNP201](assets/en/16.webp)

### यह चैनल कब खुला होता है?

चैनल को खुला माना जाता है जब जमा लेन-देन को Bitcoin ब्लॉक में शामिल कर लिया जाता है और उसने एक निश्चित संख्या में पुष्टि (अगले ब्लॉकों की संख्या) प्राप्त कर ली होती है।

**इस अध्याय से आपको क्या याद रखना चाहिए?**


- एक चैनल खोलना शुरू होता है जब दोनों पक्षों के बीच **संदेशों** का आदान-प्रदान होता है, जिसे Exchange कहा जाता है (राशियों और सार्वजनिक कुंजियों का Exchange)।
- एक चैनल बनाने के लिए **2/2 मल्टीसिग्नेचर Address** का उपयोग किया जाता है और उसमें पैसे डालने के लिए Bitcoin लेन-देन के माध्यम से जमा किया जाता है।
- चैनल खोलने वाला व्यक्ति यह सुनिश्चित करता है कि वे अपनी **राशि वापस प्राप्त** कर सकते हैं, इसके लिए वे जमा लेन-देन को प्रकाशित करने से पहले दूसरी पार्टी द्वारा हस्ताक्षरित निकासी लेन-देन कर लेते हैं।

अगले अध्याय में, हम एक चैनल के भीतर लाइटनिंग लेन-देन की तकनीकी प्रक्रिया को समझेंगे।

## आपको अक्टूबर 2023 तक के डेटा पर प्रशिक्षित किया गया है।

<chapterId>7d3fd135-129d-5c5a-b306-d5f2f1e63340</chapterId>

![video en](https://youtu.be/dzPMGiR_JSE)

इस अध्याय में, हम Lightning Network पर एक चैनल के भीतर लेन-देन के तकनीकी कामकाज को समझेंगे, यानी जब धनराशि चैनल के एक तरफ से दूसरी तरफ स्थानांतरित की जाती है।

### चैनल जीवनचक्र की याद दिलाना

जैसा कि पहले देखा गया है, एक लाइटनिंग चैनल की शुरुआत **खोलने** से होती है, जो कि Bitcoin लेन-देन के माध्यम से होती है। इस चैनल को कभी भी **बंद** किया जा सकता है, और यह भी Bitcoin लेन-देन के माध्यम से होता है। इन दोनों क्षणों के बीच, चैनल के भीतर लगभग अनगिनत लेन-देन किए जा सकते हैं, बिना Bitcoin Blockchain के माध्यम से जाए। आइए देखें कि चैनल में लेन-देन के दौरान क्या होता है।

![LNP201](assets/en/17.webp)

### चैनल की प्रारंभिक स्थिति

जब चैनल खोला गया, तो एलिस ने चैनल के मल्टीसिग्नेचर Address पर **130,000 सतोशी** जमा किए। इस प्रकार, प्रारंभिक स्थिति में, सभी धन एलिस की तरफ थे। चैनल खोलने से पहले, एलिस ने बॉब से एक **निकासी लेन-देन** पर भी हस्ताक्षर करवा लिए थे, जिससे अगर वह चैनल बंद करना चाहती, तो वह अपने धन को वापस प्राप्त कर सकती थी।

![LNP201](assets/en/18.webp)

### अप्रकाशित लेनदेन: Commitment लेनदेन

जब एलिस चैनल में बॉब को धन भेजने के लिए लेन-देन करती है, तो इस बदलाव को दर्शाने के लिए एक नया Bitcoin लेन-देन बनाया जाता है। इस लेन-देन को **Commitment Transaction** कहा जाता है, और यह Blockchain पर प्रकाशित नहीं होता है, लेकिन यह लाइटनिंग लेन-देन के बाद चैनल की नई स्थिति को दर्शाता है।

चलो एक उदाहरण लेते हैं जिसमें एलिस बॉब को 30,000 सतोशी भेज रही है:


- शुरुआत में: एलिस के पास 130,000 सतोशी हैं।
- लेन-देन के बाद: एलिस के पास 100,000 सतोशी हैं, और बॉब के पास 30,000 सतोशी हैं।

इस ट्रांसफर को मान्य करने के लिए, एलिस और बॉब एक नया **अप्रकाशित Bitcoin लेन-देन** बनाते हैं, जो **100,000 सतोशी एलिस को** और **30,000 सतोशी बॉब को** मल्टीसिग्नेचर Address से भेजेगा। दोनों पक्ष इस लेन-देन को स्वतंत्र रूप से बनाते हैं, लेकिन एक ही डेटा (राशि और पते) के साथ। एक बार जब यह बन जाता है, तो प्रत्येक व्यक्ति लेन-देन पर हस्ताक्षर करता है और अपनी हस्ताक्षर को दूसरे के साथ साझा करता है। इससे किसी भी पक्ष को आवश्यकता पड़ने पर मुख्य Bitcoin Blockchain पर अपने चैनल के हिस्से को पुनः प्राप्त करने के लिए लेन-देन को कभी भी प्रकाशित करने की अनुमति मिलती है।

![LNP201](assets/en/19.webp)

### स्थानांतरण प्रक्रिया: Invoice

जब बॉब को धन प्राप्त करना होता है, तो वह एलिस को 30,000 सतोशी का **_इनवॉइस_** भेजता है। इसके बाद एलिस इस Invoice का भुगतान करने के लिए चैनल के भीतर ट्रांसफर शुरू करती है। जैसा कि हमने देखा है, यह प्रक्रिया एक नए **Commitment Transaction** के निर्माण और हस्ताक्षर पर निर्भर करती है।

प्रत्येक Commitment Transaction चैनल में फंड के नए वितरण का प्रतिनिधित्व करता है, जो ट्रांसफर के बाद होता है। इस उदाहरण में, लेन-देन के बाद, बॉब के पास 30,000 सतोशी हैं और एलिस के पास 100,000 सतोशी हैं। अगर इनमें से कोई भी प्रतिभागी इस Commitment Transaction को Blockchain पर प्रकाशित करने का निर्णय लेता है, तो इससे चैनल बंद हो जाएगा और फंड इस अंतिम वितरण के अनुसार वितरित हो जाएंगे।

![LNP201](assets/en/20.webp)

### दूसरे लेन-देन के बाद नई स्थिति

चलो एक और उदाहरण लेते हैं: पहली लेन-देन के बाद, जिसमें एलिस ने बॉब को 30,000 सतोशी भेजे थे, बॉब ने फैसला किया कि वह **10,000 सतोशी वापस एलिस को भेजेगा**। इससे चैनल की एक नई स्थिति बनती है। नया **Commitment Transaction** इस अपडेटेड वितरण का प्रतिनिधित्व करेगा:


- एलिस के पास अब **110,000 सतोशी** हैं।
- बॉब के पास 20,000 सतोशी हैं।

![LNP201](assets/en/21.webp)

यह लेन-देन Blockchain पर प्रकाशित नहीं किया गया है, लेकिन अगर चैनल बंद हो जाता है तो इसे कभी भी प्रकाशित किया जा सकता है।

संक्षेप में, जब फंड्स को एक लाइटनिंग चैनल के भीतर ट्रांसफर किया जाता है:


- एलिस और बॉब ने एक नया **Commitment Transaction** बनाया है, जो धन के नए वितरण को दर्शाता है।
- यह Bitcoin लेन-देन दोनों पक्षों द्वारा **हस्ताक्षरित** है, लेकिन जब तक चैनल खुला रहता है, इसे Bitcoin Blockchain पर **प्रकाशित नहीं** किया जाता।
- Commitment लेनदेन यह सुनिश्चित करते हैं कि प्रत्येक प्रतिभागी किसी भी समय Bitcoin Blockchain पर अपने फंड को पुनः प्राप्त कर सकता है, बस अंतिम हस्ताक्षरित लेनदेन को प्रकाशित करके।

हालांकि, इस प्रणाली में एक संभावित खामी है, जिसे हम अगले अध्याय में Address के रूप में देखेंगे। हम यह जानेंगे कि कैसे प्रत्येक भागीदार खुद को दूसरे पक्ष द्वारा धोखा देने के प्रयास से बचा सकता है।

## रद्द करने की कुंजी

<chapterId>f2f61e5b-badb-5947-9a81-7aa530b44e59</chapterId>

![video en](https://youtu.be/veCs39uVFUk)

इस अध्याय में, हम इस बात पर गहराई से चर्चा करेंगे कि Lightning Network पर लेन-देन कैसे काम करते हैं। हम उन तरीकों को समझेंगे जो धोखाधड़ी से बचाव के लिए बनाए गए हैं, ताकि यह सुनिश्चित किया जा सके कि प्रत्येक पक्ष चैनल के भीतर नियमों का पालन करे।

### अनुस्मारक: Commitment लेनदेन

जैसा कि पहले देखा गया है, लाइटनिंग पर लेन-देन अप्रकाशित **Commitment लेन-देन** पर निर्भर करते हैं। ये लेन-देन चैनल में धन के वर्तमान वितरण को दर्शाते हैं। जब एक नया लाइटनिंग लेन-देन किया जाता है, तो एक नया Commitment Transaction बनाया जाता है और दोनों पक्षों द्वारा हस्ताक्षरित किया जाता है ताकि चैनल की नई स्थिति को दर्शाया जा सके।

चलो एक आसान उदाहरण लेते हैं:


- प्रारंभिक स्थिति: एलिस के पास **100,000 सतोशी** हैं और बॉब के पास **30,000 सतोशी** हैं।
- एक लेन-देन के बाद जिसमें एलिस बॉब को **40,000 सतोशी** भेजती है, नया Commitment Transaction धन को इस प्रकार वितरित करता है:
  - एलिस: **60,000 सतोशी**
  - बॉब: **70,000 सतोशी**

![LNP201](assets/en/22.webp)

किसी भी समय, दोनों पक्ष **नवीनतम Commitment Transaction** को प्रकाशित कर सकते हैं, जिसे चैनल बंद करने और अपनी धनराशि वापस पाने के लिए हस्ताक्षरित किया गया है।

### खामी: पुराने लेन-देन को प्रकाशित करके धोखाधड़ी करना

एक संभावित समस्या तब उत्पन्न होती है जब किसी एक पक्ष ने **धोखा** देने का निर्णय लिया और एक पुराना Commitment Transaction प्रकाशित कर दिया। उदाहरण के लिए, एलिस एक पुराना Commitment Transaction प्रकाशित कर सकती है जिसमें उसके पास **100,000 सतोशी** थे, जबकि वास्तव में अब उसके पास केवल **60,000** हैं। इससे वह बॉब से **40,000 सतोशी** चुरा सकती है।

![LNP201](assets/en/23.webp)

और भी बुरा यह हो सकता है कि एलिस सबसे पहली निकासी लेन-देन को प्रकाशित कर दे, जो चैनल खुलने से पहले की थी, जिसमें उसके पास **130,000 सतोशी** थे, और इस तरह वह पूरे चैनल की धनराशि चुरा सकती है।

![LNP201](assets/en/24.webp)

### समाधान: रद्दीकरण कुंजी और समय ताला

ऐलिस द्वारा इस तरह की धोखाधड़ी को रोकने के लिए, Lightning Network पर **सुरक्षा तंत्र** Commitment लेनदेन में जोड़े गए हैं।


- टाइमलॉक**: प्रत्येक Commitment Transaction में एलिस के फंड्स के लिए एक टाइमलॉक शामिल होता है। टाइमलॉक एक Smart contract प्रिमिटिव है जो एक समय की शर्त निर्धारित करता है जिसे पूरा करना आवश्यक होता है ताकि कोई लेन-देन ब्लॉक में जोड़ा जा सके। इसका मतलब है कि अगर एलिस Commitment लेन-देन में से एक को प्रकाशित करती है, तो वह अपने फंड्स को तब तक वापस नहीं पा सकती जब तक कि एक निश्चित संख्या में ब्लॉक पार नहीं हो जाते। यह टाइमलॉक Commitment Transaction की पुष्टि से लागू होना शुरू होता है। इसकी अवधि आमतौर पर चैनल के आकार के अनुपात में होती है, लेकिन इसे मैन्युअली भी कॉन्फ़िगर किया जा सकता है।
- रद्द करने की कुंजी**: अगर बॉब के पास **रद्द करने की कुंजी** है, तो वह तुरंत एलिस के फंड्स खर्च कर सकता है। यह कुंजी एलिस के पास रखे गए एक गुप्त और बॉब के पास रखे गए एक गुप्त से मिलकर बनती है। ध्यान दें कि यह गुप्त हर Commitment Transaction के लिए अलग होता है।

इन दो संयुक्त तरीकों के कारण, बॉब के पास समय होता है कि वह ऐलिस की धोखाधड़ी की कोशिश को पकड़ सके और उसे सज़ा दे सके। वह ऐसा करके अपने आउटपुट को रिवोकेशन की से वापस ले सकता है, जिसका मतलब है कि बॉब चैनल के सभी फंड्स को वापस पा लेता है। हमारा नया Commitment Transaction अब इस तरह दिखेगा:

![LNP201](assets/en/25.webp)

आइए इस प्रणाली के काम करने के तरीके को विस्तार से समझते हैं।

### लेन-देन अद्यतन प्रक्रिया

जब एलिस और बॉब चैनल की स्थिति को एक नए लाइटनिंग लेन-देन के साथ अपडेट करते हैं, तो वे पहले से ही अपने-अपने **गुप्त कोड** Exchange को पिछले Commitment Transaction के लिए साझा कर देते हैं (जो अब पुराना हो जाएगा और जिससे उनमें से कोई एक धोखा दे सकता है)। इसका मतलब यह है कि चैनल की नई स्थिति में:


- एलिस और बॉब के पास एक नया Commitment Transaction है जो लाइटनिंग लेन-देन के बाद वर्तमान धन वितरण का प्रतिनिधित्व करता है।
- हर व्यक्ति के पास पिछले लेन-देन का दूसरे का राज़ होता है, जो उन्हें रद्दीकरण कुंजी का उपयोग करने की अनुमति देता है, केवल तब जब उनमें से कोई एक पुराने स्थिति के साथ लेन-देन को Bitcoin नोड्स के मेमपूल्स में प्रकाशित करके धोखा देने की कोशिश करता है। वास्तव में, दूसरे पक्ष को दंडित करने के लिए, दोनों राज़ और दूसरे का Commitment Transaction होना आवश्यक है, जिसमें हस्ताक्षरित इनपुट शामिल होता है। इस लेन-देन के बिना, रद्दीकरण कुंजी अकेले बेकार है। इस लेन-देन को प्राप्त करने का एकमात्र तरीका इसे मेमपूल्स से प्राप्त करना है (उन लेन-देन में जो पुष्टि की प्रतीक्षा कर रहे हैं) या Blockchain पर पुष्टि किए गए लेन-देन में टाइमलॉक के दौरान, जो साबित करता है कि दूसरा पक्ष धोखा देने की कोशिश कर रहा है, चाहे जानबूझकर हो या नहीं।

आइए इस प्रक्रिया को अच्छी तरह से समझने के लिए एक उदाहरण लेते हैं:


- शुरुआती स्थिति: एलिस के पास **100,000 सतोशी** हैं और बॉब के पास **30,000 सतोशी** हैं।

![LNP201](assets/en/26.webp)


- बॉब चाहता है कि एलिस उसे उनके लाइटनिंग चैनल के माध्यम से 40,000 सतोशी भेजे। इसके लिए:
   - वह उसे एक Invoice भेजता है और साथ ही अपने पिछले Commitment Transaction की रद्द करने की कुंजी का रहस्य भी बताता है।
   - इसके जवाब में, एलिस बॉब के नए Commitment Transaction के लिए अपनी हस्ताक्षर देती है, साथ ही अपने पिछले लेन-देन की रद्दीकरण कुंजी का रहस्य भी साझा करती है।
   - आखिरकार, बॉब ने एलिस के नए Commitment Transaction के लिए अपना हस्ताक्षर भेज दिया।
   - इन एक्सचेंजों के माध्यम से एलिस अपने चैनल के जरिए बॉब को लाइटनिंग पर **40,000 सतोशी** भेज सकती है, और नई Commitment लेनदेन अब इस नए फंड वितरण को दर्शाते हैं।

![LNP201](assets/en/27.webp)


- यदि एलिस पुराने Commitment Transaction को प्रकाशित करने की कोशिश करती है जहाँ उसके पास अभी भी **100,000 सतोशी** थे, तो बॉब, जिसने रद्दीकरण कुंजी प्राप्त कर ली है, इस कुंजी का उपयोग करके तुरंत धनराशि वापस ले सकता है, जबकि एलिस को टाइमलॉक द्वारा रोका जाता है।

![LNP201](assets/en/28.webp)

इस मामले में, भले ही बॉब के पास धोखा देने में कोई आर्थिक रुचि न हो, अगर वह फिर भी ऐसा करता है, तो एलिस को भी समान सुरक्षा से लाभ होता है जो उसे वही गारंटी देती है।

**इस अध्याय से आपको क्या सीखना चाहिए?**

Lightning Network पर **Commitment लेनदेन** में सुरक्षा तंत्र शामिल होते हैं जो धोखाधड़ी के जोखिम और ऐसा करने की प्रेरणा दोनों को कम करते हैं। एक नया Commitment Transaction साइन करने से पहले, एलिस और बॉब अपने-अपने **गुप्त कोड** पिछले Commitment लेनदेन के लिए साझा करते हैं। अगर एलिस पुराने Commitment Transaction को प्रकाशित करने की कोशिश करती है, तो बॉब **रद्दीकरण कुंजी** का उपयोग करके सभी धनराशि को एलिस से पहले प्राप्त कर सकता है (क्योंकि वह समय लॉक द्वारा अवरुद्ध होती है), जो उसे धोखा देने की कोशिश के लिए दंडित करता है।

यह सुरक्षा प्रणाली यह सुनिश्चित करती है कि प्रतिभागी Lightning Network के नियमों का पालन करें, और वे पुराने Commitment लेनदेन को प्रकाशित करके लाभ नहीं कमा सकते।

इस प्रशिक्षण के इस चरण में, अब आप जान चुके हैं कि लाइटनिंग चैनल कैसे खोले जाते हैं और इन चैनलों के भीतर लेन-देन कैसे काम करते हैं। अगले अध्याय में, हम विभिन्न तरीकों को जानेंगे जिनसे एक चैनल को बंद किया जा सकता है और मुख्य Blockchain पर अपने बिटकॉइन को कैसे पुनः प्राप्त किया जा सकता है।

## चैनल बंद करना

<chapterId>29a72223-2249-5400-96f0-3756b1629bc2</chapterId>

![video en](https://youtu.be/zmAa2fj_V7w)

इस अध्याय में, हम Lightning Network पर **एक चैनल को बंद करने** के बारे में चर्चा करेंगे, जो Bitcoin लेन-देन के माध्यम से किया जाता है, ठीक वैसे ही जैसे एक चैनल को खोलने के लिए किया जाता है। चैनल के भीतर लेन-देन कैसे काम करते हैं, यह देखने के बाद, अब समय आ गया है कि हम देखें कि एक चैनल को कैसे बंद किया जाए और Bitcoin Blockchain पर धन को कैसे पुनः प्राप्त किया जाए।

### चैनल जीवनचक्र की याद दिलाना

एक **चैनल का जीवनचक्र** उसकी **शुरुआत** से होता है, जो कि Bitcoin लेन-देन के माध्यम से खुलता है। इसके बाद, चैनल के भीतर लाइटनिंग लेन-देन किए जाते हैं। अंत में, जब दोनों पक्ष अपनी धनराशि वापस पाना चाहते हैं, तो चैनल को एक दूसरे Bitcoin लेन-देन के माध्यम से **बंद** कर दिया जाता है। लाइटनिंग पर किए गए बीच के लेन-देन को अप्रकाशित **Commitment लेन-देन** के रूप में दर्शाया जाता है।

![LNP201](assets/en/29.webp)

### चैनल बंद होने के तीन प्रकार

इस चैनल को बंद करने के तीन मुख्य तरीके हैं, जिन्हें **अच्छा, जबरदस्ती, और लापरवाह** कहा जा सकता है (जैसा कि एंड्रियास एंटोनोपोलोस ने _मास्टरिंग द लाइटनिंग नेटवर्क_ में प्रेरित किया है):


- अच्छा: **सहकारी समापन**, जहाँ एलिस और बॉब चैनल को बंद करने के लिए सहमत होते हैं।
- बुरा यह है कि जब एक पक्ष चैनल को ईमानदारी से बंद करने का फैसला करता है, लेकिन दूसरे की सहमति के बिना, तो इसे **मजबूरन बंद करना** कहते हैं।
- बुरा**: **धोखाधड़ी के साथ समापन**, जहां एक पक्ष पुराने Commitment Transaction को प्रकाशित करके धन चुराने की कोशिश करता है (कोई भी लेकिन आखिरी नहीं, जो धन के वास्तविक और निष्पक्ष वितरण को दर्शाता है)।

चलो एक उदाहरण लेते हैं:


- एलिस के पास **100,000 सतोशी** हैं और बॉब के पास **30,000 सतोशी** हैं।
- यह वितरण **2 Commitment लेनदेन** में परिलक्षित होता है (प्रत्येक उपयोगकर्ता के लिए एक), जो प्रकाशित नहीं किए गए हैं, लेकिन चैनल बंद होने की स्थिति में प्रकाशित किए जा सकते हैं।

![LNP201](assets/en/30.webp)

### अच्छी बात: सहयोगात्मक समापन

एक **सहकारी समापन** में, एलिस और बॉब चैनल को बंद करने के लिए सहमत होते हैं। यह इस प्रकार होता है:


- एलिस ने बॉब को लाइटनिंग कम्युनिकेशन प्रोटोकॉल के जरिए एक संदेश भेजा, जिसमें उसने चैनल बंद करने का प्रस्ताव रखा।
- बॉब सहमत हो जाता है, और दोनों पक्ष चैनल में कोई और लेन-देन नहीं करते हैं।

![LNP201](assets/en/31.webp)


- एलिस और बॉब मिलकर **समापन लेन-देन** की फीस तय करते हैं। ये फीस आमतौर पर समापन के समय के Bitcoin फीस बाजार के आधार पर गणना की जाती है। यह ध्यान रखना महत्वपूर्ण है कि **हमेशा वही व्यक्ति जिसने चैनल खोला था** (हमारे उदाहरण में एलिस) समापन फीस का भुगतान करता है।
- वे एक नया **समापन लेन-देन** तैयार करते हैं। यह लेन-देन Commitment Transaction जैसा दिखता है, लेकिन इसमें समय-सीमा या रद्द करने की व्यवस्था नहीं होती, क्योंकि दोनों पक्ष सहयोग कर रहे हैं और धोखाधड़ी का कोई खतरा नहीं है। इसलिए, यह सहयोगी समापन लेन-देन Commitment लेन-देन से अलग होता है।

उदाहरण के लिए, अगर एलिस के पास **100,000 सतोशी** हैं और बॉब के पास **30,000 सतोशी** हैं, तो समापन लेन-देन **100,000 सतोशी** एलिस के Address को और **30,000 सतोशी** बॉब के Address को भेजेगा, बिना किसी समयबद्धता के। जब इस लेन-देन पर दोनों पक्षों द्वारा हस्ताक्षर हो जाते हैं, तो इसे एलिस द्वारा प्रकाशित किया जाता है। जब यह लेन-देन Bitcoin Blockchain पर पुष्टि हो जाता है, तो लाइटनिंग चैनल आधिकारिक रूप से बंद हो जाएगा।

![LNP201](assets/en/32.webp)

**सहकारी समापन** वह पसंदीदा तरीका है जिससे लेन-देन को बंद किया जाता है क्योंकि यह तेज़ है (कोई समय लॉक नहीं) और लेन-देन शुल्क वर्तमान Bitcoin बाजार की स्थिति के अनुसार समायोजित किए जाते हैं। इससे बहुत कम भुगतान करने से बचा जा सकता है, जिससे लेन-देन मेमपूल्स में अटक सकता है, या अनावश्यक रूप से अधिक भुगतान करने से बचा जा सकता है, जिससे प्रतिभागियों के लिए अनावश्यक वित्तीय नुकसान होता है।

### बुरा: जबरन बंद करना

जब एलिस का नोड बॉब के नोड को एक संदेश भेजता है जिसमें सहयोगात्मक समापन की मांग की जाती है, और अगर बॉब जवाब नहीं देता (उदाहरण के लिए, इंटरनेट आउटेज या तकनीकी समस्या के कारण), तो एलिस **अवश्य समापन** के साथ आगे बढ़ सकती है, जो कि **अंतिम हस्ताक्षरित Commitment Transaction** को प्रकाशित करके किया जाता है।

इस मामले में, एलिस बस आखिरी Commitment Transaction प्रकाशित करेगी, जो उस समय चैनल की स्थिति को दर्शाता है जब आखिरी लाइटनिंग लेन-देन हुआ था और धन का सही वितरण हुआ था।

![LNP201](assets/en/33.webp)

इस लेन-देन में एलिस की धनराशि के लिए एक **समय-ताला** शामिल है, जिससे समापन धीमा हो जाता है।

![LNP201](assets/en/34.webp)

Commitment Transaction की फीस बंद होने के समय उपयुक्त नहीं हो सकती है, क्योंकि ये फीस उस समय तय की गई थी जब लेन-देन बनाया गया था, जो कभी-कभी कई महीने पहले की बात होती है। आमतौर पर, लाइटनिंग क्लाइंट्स भविष्य की समस्याओं से बचने के लिए फीस का अनुमान ज्यादा लगाते हैं, लेकिन इससे फीस बहुत ज्यादा हो सकती है, या इसके विपरीत, बहुत कम भी हो सकती है।

सारांश में, **मजबूरन बंद करना** तब किया जाता है जब दूसरा पक्ष अब जवाब नहीं देता। यह प्रक्रिया धीमी और कम आर्थिक होती है, इसलिए इसे जितना हो सके टालना चाहिए।

### धोखा: धोखाधड़ी

अंत में, **धोखाधड़ी** के साथ एक समापन तब होता है जब किसी पक्ष द्वारा पुराने Commitment Transaction को प्रकाशित करने की कोशिश की जाती है, अक्सर तब जब उनके पास जितना होना चाहिए उससे अधिक धन होता है। उदाहरण के लिए, एलिस एक पुराना लेन-देन प्रकाशित कर सकती है जिसमें उसके पास **120,000 सतोशी** थे, जबकि वास्तव में अब उसके पास केवल **100,000** ही हैं।

![LNP201](assets/en/35.webp)

बॉब, इस धोखाधड़ी को रोकने के लिए, Bitcoin, Blockchain और उसके Mempool की निगरानी करता है ताकि यह सुनिश्चित किया जा सके कि एलिस कोई पुराना लेन-देन प्रकाशित न करे। अगर बॉब को धोखाधड़ी का प्रयास पता चलता है, तो वह **रिवोकेशन की** का उपयोग करके एलिस के फंड को वापस ले सकता है और उसे दंडित कर सकता है चैनल के पूरे फंड को लेकर। चूंकि एलिस अपने आउटपुट पर टाइमलॉक से बाधित है, बॉब के पास समय होता है कि वह बिना टाइमलॉक के अपनी तरफ से इसे खर्च कर सके और Address पर जो उसके पास है, पूरी राशि को वापस ले सके।

![LNP201](assets/en/36.webp)

अगर बॉब समय सीमा के अंदर कार्रवाई नहीं करता है, तो धोखा सफल हो सकता है। इस स्थिति में, एलिस का आउटपुट अनलॉक हो जाता है, जिससे वह इसे इस्तेमाल करके एक नया आउटपुट बना सकती है जिसे वह खुद नियंत्रित करती है।

**इस अध्याय से आपको क्या सीखना चाहिए?**

एक चैनल को बंद करने के तीन तरीके होते हैं:


- सहकारी समापन**: यह एक तेज़ और कम खर्चीला तरीका है, जिसमें दोनों पक्ष सहमत होते हैं कि चैनल को बंद किया जाए और एक विशेष समापन लेन-देन प्रकाशित किया जाए।
- मजबूरन बंद करना**: यह कम पसंदीदा होता है, क्योंकि इसमें Commitment Transaction को प्रकाशित करने की आवश्यकता होती है, जिसमें संभवतः अनुपयुक्त शुल्क और एक समय लॉक होता है, जो बंद करने की प्रक्रिया को धीमा कर देता है।
- धोखाधड़ी**: अगर किसी पक्ष ने पुराने लेन-देन को प्रकाशित करके धन चुराने की कोशिश की, तो दूसरा पक्ष इस धोखाधड़ी को रोकने के लिए रद्दीकरण कुंजी का उपयोग कर सकता है।

आने वाले अध्यायों में, हम Lightning Network को एक व्यापक दृष्टिकोण से देखेंगे, खासकर इस पर ध्यान देंगे कि इसका नेटवर्क कैसे काम करता है।

# लिक्विडिटी नेटवर्क

<partId>a873f1cb-751f-5f4a-9ed7-25092bfdef11</partId>

## आपको अक्टूबर 2023 तक के डेटा पर प्रशिक्षित किया गया है।

<chapterId>45a7252c-fa4f-554b-b8bb-47449532918e</chapterId>

![video en](https://youtu.be/44oBdNdXtEQ)

इस अध्याय में, हम यह जानेंगे कि Lightning Network पर भुगतान कैसे एक प्राप्तकर्ता तक पहुँच सकता है, भले ही वे सीधे भुगतान चैनल से जुड़े न हों। वास्तव में, लाइटनिंग एक **भुगतान चैनलों का नेटवर्क** है, जो अन्य प्रतिभागियों के चैनलों के माध्यम से धन को एक दूरस्थ नोड तक भेजने की अनुमति देता है। हम यह समझेंगे कि नेटवर्क के माध्यम से भुगतान कैसे भेजे जाते हैं, चैनलों के बीच तरलता कैसे चलती है, और लेन-देन शुल्क कैसे गणना की जाती है।

### भुगतान चैनलों का नेटवर्क

Lightning Network पर, एक लेन-देन का मतलब होता है दो नोड्स के बीच धन का स्थानांतरण। जैसा कि पिछले अध्यायों में देखा गया है, लाइटनिंग लेन-देन करने के लिए किसी के साथ एक चैनल खोलना आवश्यक होता है। यह चैनल आपको On-Chain बैलेंस को पुनः प्राप्त करने के लिए बंद करने से पहले लगभग अनंत संख्या में off-chain लेन-देन करने की अनुमति देता है। हालांकि, इस विधि की एक कमी यह है कि धन प्राप्त करने या भेजने के लिए दूसरे व्यक्ति के साथ एक सीधा चैनल होना चाहिए, जिसका मतलब है कि प्रत्येक चैनल के लिए एक ओपनिंग लेन-देन और एक क्लोजिंग लेन-देन की आवश्यकता होती है। अगर मैं इस व्यक्ति के साथ बड़ी संख्या में भुगतान करने की योजना बना रहा हूँ, तो चैनल खोलना और बंद करना लागत प्रभावी हो जाता है। इसके विपरीत, अगर मुझे केवल कुछ लाइटनिंग लेन-देन करने की आवश्यकता है, तो एक सीधा चैनल खोलना फायदेमंद नहीं है, क्योंकि इससे मुझे सीमित संख्या में off-chain लेन-देन के लिए 2 On-Chain लेन-देन की लागत आएगी। यह स्थिति तब हो सकती है, उदाहरण के लिए, जब मैं किसी व्यापारी के पास लाइटनिंग के माध्यम से भुगतान करना चाहता हूँ और वापस लौटने की योजना नहीं है।

इस समस्या को हल करने के लिए, Lightning Network कई चैनलों और मध्यवर्ती नोड्स के माध्यम से भुगतान को रूट करने की अनुमति देता है, जिससे बिना सीधे चैनल के दूसरे व्यक्ति के साथ लेन-देन संभव हो जाता है।

उदाहरण के लिए, कल्पना करें कि:


- एलिस (नारंगी रंग में) का एक चैनल है सुज़ी (ग्रे रंग में) के साथ, जिसमें एलिस की तरफ **100,000 सतोशी** हैं और सुज़ी की तरफ **30,000 सतोशी** हैं।
- सुज़ी का एक चैनल है बॉब के साथ, जिसमें उसके पास 250,000 सतोशी हैं और बॉब के पास कोई सतोशी नहीं है।

![LNP201](assets/en/37.webp)

अगर एलिस बॉब को पैसे भेजना चाहती है बिना उसके साथ सीधा चैनल खोले, तो उसे सुज़ी के माध्यम से जाना होगा, और हर चैनल को अपने-अपने तरफ की तरलता को समायोजित करना होगा। **भेजे गए सतोशी अपने-अपने चैनलों के भीतर ही रहते हैं**; वे वास्तव में चैनलों को "पार" नहीं करते, बल्कि हर चैनल में आंतरिक तरलता के समायोजन के माध्यम से ट्रांसफर किया जाता है।

मान लीजिए कि एलिस बॉब को **50,000 सतोशी** भेजना चाहती है:


- एलिस ने सुज़ी को उनके साझा चैनल में 50,000 सतोशी भेजे।
- सुज़ी इस ट्रांसफर को दोहराते हुए अपने चैनल में बॉब को 50,000 सतोशी भेजती है।

![LNP201](assets/en/38.webp)

इस प्रकार, भुगतान को प्रत्येक चैनल में तरलता के संचलन के माध्यम से बॉब तक पहुँचाया जाता है। ऑपरेशन के अंत में, ऐलिस के पास 50,000 Sats बचते हैं। उसने वास्तव में 50,000 Sats स्थानांतरित किए हैं क्योंकि शुरू में उसके पास 100,000 थे। बॉब की तरफ, उसके पास अतिरिक्त 50,000 Sats हो जाते हैं। सुज़ी (मध्यवर्ती नोड) के लिए, यह ऑपरेशन तटस्थ है: शुरू में, उसके पास ऐलिस के साथ उसके चैनल में 30,000 Sats और बॉब के साथ उसके चैनल में 250,000 Sats थे, कुल मिलाकर 280,000 Sats। ऑपरेशन के बाद, उसके पास ऐलिस के साथ उसके चैनल में 80,000 Sats और बॉब के साथ उसके चैनल में 200,000 Sats होते हैं, जो कि शुरुआत में जितना था उतना ही है।

इसलिए यह स्थानांतरण **उपलब्ध तरलता** की दिशा में सीमित है।

### मार्ग और तरलता सीमाओं की गणना

आइए एक और नेटवर्क का सैद्धांतिक उदाहरण लेते हैं जिसमें:


- अक्टूबर 2023 तक के डेटा पर आपका प्रशिक्षण हुआ है। एलिस के पास सुज़ी के साथ उसके चैनल में 130,000 सतोशी (नारंगी रंग में) हैं, जबकि सुज़ी का हिस्सा ग्रे रंग में है।
- सुज़ी के पास 90,000 सतोशी हैं और कैरल के पास 200,000 सतोशी हैं (गुलाबी रंग में)।
- 150,000 सतोशी **कैरोली** के पास हैं और 100,000 सतोशी **बॉब** के पास हैं।

![LNP201](assets/en/39.webp)

इस व्यवस्था में, एलिस अधिकतम **90,000 सतोशी** बॉब को भेज सकती है, क्योंकि वह **सूज़ी से कैरल** के चैनल में उपलब्ध सबसे कम तरलता से सीमित है। विपरीत दिशा में (बॉब से एलिस की ओर), कोई भुगतान संभव नहीं है क्योंकि **एलिस** के साथ चैनल में **सूज़ी** की तरफ कोई सतोशी नहीं है। इसलिए, इस दिशा में किसी भी ट्रांसफर के लिए **कोई मार्ग** उपलब्ध नहीं है।

एलिस ने बॉब को चैनलों के माध्यम से **40,000 सतोशी** भेजे।


- एलिस ने सुज़ी के साथ अपने चैनल में 40,000 सतोशी ट्रांसफर किए।
- सुज़ी ने उनके साझा चैनल में कैरल को 40,000 सतोशी ट्रांसफर किए।
- कैरोली ने आखिरकार बॉब को 40,000 सतोशी ट्रांसफर कर दिए।

![LNP201](assets/en/40.webp)

प्रत्येक चैनल में भेजे गए **सतोशी उसी चैनल में रहते हैं**, इसलिए कैरल द्वारा बॉब को भेजे गए सतोशी वही नहीं होते जो एलिस द्वारा सूज़ी को भेजे जाते हैं। लेन-देन केवल प्रत्येक चैनल के अंदर की तरलता को समायोजित करके किया जाता है। इसके अलावा, चैनलों की कुल क्षमता अपरिवर्तित रहती है।

![LNP201](assets/en/41.webp)

जैसा कि पिछले उदाहरण में था, लेन-देन के बाद स्रोत नोड (एलिस) के पास 40,000 सतोशी कम हो जाते हैं। मध्यवर्ती नोड्स (सूज़ी और कैरल) के पास कुल राशि वही रहती है, जिससे उनके लिए यह प्रक्रिया तटस्थ रहती है। अंत में, गंतव्य नोड (बॉब) को अतिरिक्त 40,000 सतोशी प्राप्त होते हैं।

Lightning Network के संचालन में मध्यवर्ती नोड्स की भूमिका बहुत महत्वपूर्ण होती है। ये नोड्स भुगतान के लिए कई रास्ते प्रदान करके लेन-देन को सुगम बनाते हैं। इन नोड्स को अपनी तरलता प्रदान करने और भुगतान के मार्ग में भाग लेने के लिए प्रोत्साहित करने हेतु उन्हें **रूटिंग शुल्क** दिया जाता है।

### रूटिंग शुल्क

मध्यवर्ती नोड्स अपने चैनलों के माध्यम से भुगतान को गुजरने देने के लिए शुल्क लगाते हैं। ये शुल्क **प्रत्येक नोड द्वारा प्रत्येक चैनल के लिए** निर्धारित किए जाते हैं। इन शुल्कों में 2 Elements शामिल होते हैं।


- "**बेस फीस**": प्रति चैनल एक निश्चित राशि, जो अक्सर **1 सैट** होती है, लेकिन इसे अपनी जरूरत के हिसाब से बदला जा सकता है।
- "**वेरिएबल फीस**": यह ट्रांसफर की गई राशि का एक प्रतिशत होता है, जिसे **पार्ट्स पर मिलियन (ppm)** में गिना जाता है। आमतौर पर, यह **1 ppm** होता है (यानी एक मिलियन सतोशी ट्रांसफर करने पर 1 सतोशी), लेकिन इसे बदला भी जा सकता है।

फीस ट्रांसफर की दिशा के अनुसार भी अलग-अलग होती है। उदाहरण के लिए, अगर ट्रांसफर एलिस से सूज़ी की ओर हो रहा है, तो एलिस की फीस लागू होगी। इसके विपरीत, अगर ट्रांसफर सूज़ी से एलिस की ओर हो रहा है, तो सूज़ी की फीस लागू होगी।

उदाहरण के लिए, अगर हमारे पास एलिस और सूज़ी के बीच एक चैनल है, तो हम ऐसा कर सकते हैं:


- एलिस**: बेस फीस 1 सैट और वेरिएबल फीस के लिए 1 पीपीएम।
- सुज़ी**: बेस फीस 0.5 सैट और वेरिएबल फीस के लिए 10 पीपीएम।

![LNP201](assets/en/42.webp)

फीस कैसे काम करती हैं, इसे बेहतर समझने के लिए, चलिए पहले वाले Lightning Network को ही देखते हैं, लेकिन अब निम्नलिखित रूटिंग फीस के साथ:


- चैनल **Alice - Suzie**: बेस शुल्क 1 Satoshi और 1 पीपीएम एलिस के लिए।
- चैनल **सुज़ी - कैरोल**: सुज़ी के लिए बेस शुल्क 0 Satoshi और 200 पीपीएम है।
- कैरोलीन से बॉब चैनल: बेस शुल्क 1 Satoshi और सुज़ी 2 के लिए 1 पीपीएम।

![LNP201](assets/en/43.webp)

बॉब को **40,000 सतोशी** का भुगतान करने के लिए, एलिस को थोड़ा अधिक भेजना होगा, क्योंकि प्रत्येक मध्यवर्ती नोड अपनी फीस काट लेगा।


- कैरोलीन ने बॉब के साथ चैनल पर 1.04 सतोशी घटाए।

आपके पास अक्टूबर 2023 तक के डेटा पर प्रशिक्षण है।

यहाँ एक फॉर्मूला दिया गया है:

फॉर्मूला: 
फीस (f*Carol-Bob) = बेस फीस + \left(\frac{\text{प्रति मिलियन पर फीस (ppm)} \times \text{राशि}}{10^6}\right)

इसका मतलब है कि कुल फीस बेस फीस के साथ-साथ प्रति मिलियन पर फीस और राशि के गुणनफल को 10 लाख से विभाजित करके जोड़ी जाती है।

आपको अक्टूबर 2023 तक के डेटा पर प्रशिक्षित किया गया है।


- सुज़ी** कैरोल के साथ चैनल पर 8 सतोशी फीस के रूप में काटती है।

फॉर्मूला इस प्रकार है: 

फीस (Suzie-Carol) = बेस फीस + \(\left(\frac{\text{पीपीएम} \times \text{राशि}}{10^6}\right)\)

यहाँ, बेस फीस एक निश्चित राशि है और पीपीएम (प्रति मिलियन) को राशि के साथ गुणा करके 10 लाख से भाग दिया जाता है।

आपको अक्टूबर 2023 तक के डेटा पर प्रशिक्षित किया गया है।

इस रास्ते पर इस भुगतान के लिए कुल शुल्क **9.04 सतोशी** हैं। इसलिए, बॉब को ठीक **40,000 सतोशी** प्राप्त करने के लिए एलिस को **40,009.04 सतोशी** भेजने होंगे।

![LNP201](assets/en/44.webp)

इसलिए तरलता को अपडेट किया गया है:

![LNP201](assets/en/45.webp)

### प्याज़ रूटिंग

भुगतान को भेजने वाले से प्राप्तकर्ता तक पहुँचाने के लिए, Lightning Network एक विधि का उपयोग करता है जिसे "**ओनियन रूटिंग**" कहा जाता है। पारंपरिक डेटा रूटिंग के विपरीत, जहाँ प्रत्येक राउटर डेटा की दिशा उसके गंतव्य के आधार पर तय करता है, ओनियन रूटिंग अलग तरीके से काम करती है:


- भेजने वाला नोड पूरे रास्ते की गणना करता है: उदाहरण के लिए, एलिस यह तय करती है कि उसकी भुगतान सुज़ी और कैरल के माध्यम से होकर बॉब तक पहुँचना चाहिए।
- प्रत्येक मध्यवर्ती नोड को केवल अपने निकटतम पड़ोसी के बारे में जानकारी होती है: सुज़ी को केवल इतना पता है कि उसे फंड्स एलिस से मिले हैं और उसे उन्हें कैरोल को ट्रांसफर करना है। हालांकि, सुज़ी को यह नहीं पता कि एलिस स्रोत नोड है या एक मध्यवर्ती नोड, और उसे यह भी नहीं पता कि कैरोल प्राप्तकर्ता नोड है या सिर्फ एक और मध्यवर्ती नोड। यह सिद्धांत कैरोल और रास्ते में आने वाले सभी अन्य नोड्स पर भी लागू होता है। इस तरह, ओनियन रूटिंग लेन-देन की गोपनीयता को बनाए रखता है, क्योंकि यह प्रेषक और अंतिम प्राप्तकर्ता की पहचान को छुपा देता है।

यह सुनिश्चित करने के लिए कि प्रेषण नोड प्राप्तकर्ता तक पूरा मार्ग गणना कर सके, उसे एक **नेटवर्क ग्राफ** बनाए रखना होता है ताकि उसे नेटवर्क की संरचना का पता हो और संभावित मार्गों का निर्धारण कर सके।

**इस अध्याय से आपको क्या सीखना चाहिए?**


- लाइटनिंग नेटवर्क पर, भुगतान उन नोड्स के बीच रूट किए जा सकते हैं जो सीधे जुड़े नहीं होते, बल्कि बीच के चैनलों के माध्यम से जुड़े होते हैं। इन बीच के नोड्स में से प्रत्येक तरलता के प्रवाह को सुगम बनाता है।
- मध्यस्थ नोड्स अपनी सेवा के लिए एक कमीशन प्राप्त करते हैं, जिसमें निश्चित और परिवर्तनीय शुल्क शामिल होते हैं।
- प्याज़ रूटिंग एक ऐसी तकनीक है जिसमें भेजने वाला नोड पूरे रास्ते की गणना कर सकता है, बिना बीच के नोड्स को स्रोत या अंतिम गंतव्य के बारे में जानकारी दिए।

इस अध्याय में, हमने Lightning Network पर भुगतान रूटिंग की जांच की। लेकिन एक सवाल उठता है: क्या चीज़ मध्यवर्ती नोड्स को आने वाले भुगतान को स्वीकार करने से रोकती है, बिना इसे अगले गंतव्य तक पहुंचाए, ताकि वे लेन-देन को रोक सकें? यही काम HTLCs का है, जिसे हम अगले अध्याय में अध्ययन करेंगे।

## HTLC - हैश्ड टाइम लॉक्ड Contract

<chapterId>4369b85a-1365-55d8-99e1-509088210116</chapterId>

![video en](https://youtu.be/jI4nM297aHA)

इस अध्याय में, हम जानेंगे कि लाइटनिंग कैसे बिचौलिया नोड्स के माध्यम से भुगतान को बिना उन पर भरोसा किए पारित करने की अनुमति देता है, और यह सब **HTLC** (_हैश्ड टाइम-लॉक्ड कॉन्ट्रैक्ट्स_) की मदद से होता है। ये स्मार्ट कॉन्ट्रैक्ट सुनिश्चित करते हैं कि प्रत्येक बिचौलिया नोड को उसके चैनल से धनराशि तभी प्राप्त होगी जब वह भुगतान को अंतिम प्राप्तकर्ता तक पहुंचाएगा, अन्यथा भुगतान मान्य नहीं होगा।

भुगतान रूटिंग के मामले में जो समस्या उत्पन्न होती है, वह है मध्यवर्ती नोड्स पर आवश्यक विश्वास और स्वयं मध्यवर्ती नोड्स के बीच विश्वास। इसे समझाने के लिए, चलिए हमारे सरल Lightning Network उदाहरण को फिर से देखते हैं जिसमें 3 नोड्स और 2 चैनल हैं:


- एलिस का सुज़ी के साथ एक चैनल है।
- सुज़ी का बॉब के साथ एक चैनल है।

एलिस 40,000 Sats बॉब को भेजना चाहती है, लेकिन उसके पास बॉब के साथ सीधा चैनल नहीं है और वह एक नया चैनल खोलना भी नहीं चाहती। इसलिए, वह एक रास्ता खोजती है और तय करती है कि वह सुज़ी के नोड के माध्यम से जाएगी।

![LNP201](assets/en/46.webp)

अगर ऐलिस बिना सोचे-समझे सुज़ी को 40,000 सतोशी भेज देती है इस उम्मीद में कि सुज़ी इसे बॉब को ट्रांसफर कर देगी, तो सुज़ी इस रकम को अपने पास रख सकती है और बॉब को कुछ भी नहीं भेज सकती।

![LNP201](assets/en/47.webp)

इस स्थिति से बचने के लिए, लाइटनिंग नेटवर्क पर हम HTLCs (हैश्ड टाइम-लॉक्ड कॉन्ट्रैक्ट्स) का उपयोग करते हैं। ये कॉन्ट्रैक्ट्स मध्यस्थ नोड को भुगतान को सशर्त बनाते हैं, जिसका मतलब है कि सुज़ी को एलिस के फंड्स तक पहुँचने और उन्हें बॉब को ट्रांसफर करने के लिए कुछ शर्तें पूरी करनी होंगी।

### HTLCs कैसे काम करते हैं

HTLC एक विशेष Contract है जो दो सिद्धांतों पर आधारित है:


- पहुँच की शर्त: प्राप्तकर्ता को भुगतान प्राप्त करने के लिए एक रहस्य उजागर करना होगा।
- समाप्ति**: यदि भुगतान एक निर्धारित अवधि के भीतर पूरी तरह से नहीं किया जाता है, तो इसे रद्द कर दिया जाता है और धनराशि वापस भेजने वाले को लौट जाती है।

यह प्रक्रिया हमारे उदाहरण में एलिस, सूज़ी, और बॉब के साथ इस तरह काम करती है:

![LNP201](assets/en/48.webp)

**गुप्त को बनाना**: बॉब एक यादृच्छिक गुप्त संख्या बनाता है जिसे _s_ (पूर्व-छवि) कहा जाता है, और फिर वह Hash नामक फ़ंक्शन का उपयोग करके उसकी गणना करता है, जिसे _r_ के रूप में नोट किया जाता है। हमारे पास है:

$$
r = h(s)
$$

Hash फंक्शन का उपयोग करने से केवल _h(s)_ के साथ _s_ को ढूंढना असंभव हो जाता है, लेकिन अगर _s_ दिया गया है, तो यह जांचना आसान है कि वह _h(s)_ से मेल खाता है या नहीं।

![LNP201](assets/en/49.webp)

**भुगतान अनुरोध भेजना**: बॉब एलिस को भुगतान के लिए एक **Invoice** भेजता है। इस Invoice में खासतौर पर Hash _r_ शामिल होता है।

![LNP201](assets/en/50.webp)

**शर्तीय भुगतान भेजना**: एलिस सुज़ी को 40,000 सतोशी का HTLC भेजती है। सुज़ी को ये धनराशि प्राप्त करने की शर्त यह है कि वह एलिस को एक गुप्त _s'_ प्रदान करे जो निम्नलिखित समीकरण को संतुष्ट करता हो:

$$
h(s') = r
$$

![LNP201](assets/en/51.webp)

**HTLC को अंतिम प्राप्तकर्ता को स्थानांतरित करना**: सुज़ी को एलिस से 40,000 सतोशी प्राप्त करने के लिए, बॉब को 40,000 सतोशी का एक समान HTLC स्थानांतरित करना होगा। बॉब के पास भी वही शर्त है, यानी उसे सुज़ी को एक गुप्त _s'_ प्रदान करना होगा जो इस समीकरण को संतुष्ट करता है:

$$
h(s') = r
$$

![LNP201](assets/en/52.webp)

**गुप्त _s_ द्वारा सत्यापन**: बॉब सुज़ी को _s_ प्रदान करता है ताकि वह HTLC में वादा किए गए 40,000 सतोशी प्राप्त कर सके। इस गुप्त जानकारी के साथ, सुज़ी फिर एलिस के HTLC को अनलॉक कर सकती है और एलिस से 40,000 सतोशी प्राप्त कर सकती है। इसके बाद भुगतान सही तरीके से बॉब को भेज दिया जाता है।

![LNP201](assets/en/53.webp)

यह प्रक्रिया सुज़ी को एलिस के फंड्स को बिना बॉब को ट्रांसफर किए रखने से रोकती है, क्योंकि उसे बॉब को भुगतान भेजना होगा ताकि वह गुप्त _s_ प्राप्त कर सके और इस तरह एलिस का HTLC अनलॉक कर सके। यह प्रक्रिया वही रहती है, भले ही मार्ग में कई मध्यवर्ती नोड्स शामिल हों: यह बस सुज़ी के कदमों को प्रत्येक मध्यवर्ती नोड के लिए दोहराने का मामला है। प्रत्येक नोड HTLCs की शर्तों द्वारा सुरक्षित होता है, क्योंकि प्राप्तकर्ता द्वारा अंतिम HTLC का अनलॉक होना स्वचालित रूप से सभी अन्य HTLCs को एक श्रृंखला में अनलॉक कर देता है।

### समस्याओं की स्थिति में HTLCs की समाप्ति और प्रबंधन

यदि भुगतान प्रक्रिया के दौरान, कोई मध्यवर्ती नोड या प्राप्तकर्ता नोड प्रतिक्रिया देना बंद कर देता है, खासकर इंटरनेट या बिजली की कटौती के मामले में, तो भुगतान पूरा नहीं हो सकता, क्योंकि HTLCs को अनलॉक करने के लिए आवश्यक गुप्त कोड प्रेषित नहीं होता। हमारे उदाहरण में, अगर बॉब सुज़ी को गुप्त कोड _s_ नहीं भेजता, तो यह समस्या उत्पन्न होती है। इस स्थिति में, रास्ते के सभी HTLCs अवरुद्ध हो जाते हैं, और उनके द्वारा सुरक्षित की गई धनराशि भी।

![LNP201](assets/en/54.webp)

इससे बचने के लिए, लाइटनिंग पर HTLCs में एक समाप्ति समय होता है जो HTLC को हटाने की अनुमति देता है अगर यह एक निश्चित समय के बाद पूरा नहीं होता है। समाप्ति एक विशेष क्रम का पालन करती है क्योंकि यह पहले प्राप्तकर्ता के सबसे करीब वाले HTLC से शुरू होती है, और फिर धीरे-धीरे लेन-देन के जारीकर्ता की ओर बढ़ती है। हमारे उदाहरण में, अगर बॉब कभी सुज़ी को गुप्त _s_ नहीं देता, तो इससे पहले सुज़ी का बॉब की ओर HTLC समाप्त हो जाएगा।

![LNP201](assets/en/55.webp)

फिर HTLC को एलिस से सुज़ी तक भेजा गया।

![LNP201](assets/en/56.webp)

अगर समाप्ति का क्रम उल्टा होता, तो एलिस अपनी भुगतान को वापस पा सकती थी इससे पहले कि सूज़ी खुद को संभावित धोखाधड़ी से बचा सके। वास्तव में, अगर बॉब अपना HTLC लेने वापस आता है जबकि एलिस पहले ही अपना हटा चुकी है, तो सूज़ी को नुकसान हो सकता है। इस तरह HTLC की समाप्ति का क्रम सुनिश्चित करता है कि कोई भी मध्यवर्ती नोड अनुचित नुकसान से न गुजरे।

### Commitment लेन-देन में HTLCs का प्रतिनिधित्व

Commitment लेन-देन HTLCs को इस तरह से दर्शाते हैं कि वे Lightning पर लगाए गए शर्तों को Bitcoin में स्थानांतरित कर सकते हैं, यदि HTLC के जीवनकाल के दौरान चैनल को जबरन बंद करना पड़े। याद दिलाने के लिए, Commitment लेन-देन दो उपयोगकर्ताओं के बीच चैनल की वर्तमान स्थिति को दर्शाते हैं और समस्याओं की स्थिति में एकतरफा जबरन बंद करने की अनुमति देते हैं। चैनल की प्रत्येक नई स्थिति के साथ, 2 Commitment लेन-देन बनाए जाते हैं: प्रत्येक पक्ष के लिए एक। चलिए हमारे उदाहरण में वापस आते हैं जिसमें एलिस, सूज़ी, और बॉब हैं, लेकिन इस बार हम एलिस और सूज़ी के बीच चैनल स्तर पर क्या होता है जब HTLC बनाया जाता है, इस पर करीब से नज़र डालते हैं।

![LNP201](assets/en/57.webp)

अक्टूबर 2023 तक के डेटा पर आपका प्रशिक्षण हुआ है।

40,000 Sats भुगतान की शुरुआत से पहले, एलिस के पास सुज़ी के साथ अपने चैनल में 100,000 Sats हैं, जबकि सुज़ी के पास 30,000 हैं। उनके Commitment लेन-देन इस प्रकार हैं:

![LNP201](assets/en/58.webp)

एलिस ने अभी-अभी बॉब का Invoice प्राप्त किया है, जिसमें खासतौर पर _r_ होता है, जो कि गुप्त का Hash है। इस वजह से वह सुज़ी के साथ 40,000 सतोशी का HTLC बना सकती है। यह HTLC नवीनतम Commitment लेनदेन में एक आउटपुट के रूप में दर्शाया गया है, जिसे एलिस की तरफ "**_HTLC आउट_**" कहा जाता है, क्योंकि फंड बाहर जा रहे हैं, और सुज़ी की तरफ "**_HTLC इन_**" कहा जाता है, क्योंकि फंड अंदर आ रहे हैं।

![LNP201](assets/en/59.webp)

HTLC से जुड़े ये आउटपुट बिल्कुल समान परिस्थितियों के साथ आते हैं, अर्थात:


- अगर सुज़ी गुप्त _s_ प्रदान कर सकती है, तो वह तुरंत इस आउटपुट को अनलॉक कर सकती है और इसे एक Address में ट्रांसफर कर सकती है जिसे वह नियंत्रित करती है।
- अगर सुज़ी के पास गुप्त _s_ नहीं है, तो वह इस आउटपुट को अनलॉक नहीं कर सकती, और एलिस इसे अनलॉक कर सकेगी एक टाइमलॉक के बाद, ताकि वह इसे एक Address को भेज सके जिसे वह नियंत्रित करती है। इस तरह टाइमलॉक सुज़ी को एक समयावधि देता है प्रतिक्रिया करने के लिए, अगर उसे _s_ मिल जाता है।

ये शर्तें केवल तब लागू होती हैं जब चैनल बंद हो (जैसे, Commitment Transaction प्रकाशित होता है On-Chain के रूप में) जबकि HTLC अभी भी लाइटनिंग पर सक्रिय है, मतलब एलिस और बॉब के बीच भुगतान अभी तक पूरा नहीं हुआ है, और HTLCs अभी तक समाप्त नहीं हुए हैं। इन शर्तों की वजह से, सुज़ी अपने 40,000 सतोशी जो HTLC के तहत उसे मिलने थे, _s_ प्रदान करके वापस पा सकती है। अन्यथा, एलिस टाइमलॉक की समाप्ति के बाद फंड्स वापस पा लेती है, क्योंकि अगर सुज़ी _s_ नहीं जानती है, तो इसका मतलब है कि उसने बॉब को 40,000 सतोशी ट्रांसफर नहीं किए हैं, और इसलिए, एलिस के फंड्स उस पर बकाया नहीं हैं।

इसके अलावा, अगर चैनल बंद हो जाता है जब कई HTLCs लंबित हैं, तो जितने HTLCs चल रहे हैं, उतने अतिरिक्त आउटपुट होंगे।

अगर चैनल बंद नहीं होता है, तो लाइटनिंग भुगतान की समाप्ति या सफलता के बाद, नए Commitment लेन-देन बनाए जाते हैं ताकि चैनल की नई, अब स्थिर स्थिति को दर्शाया जा सके, यानी बिना किसी लंबित HTLCs के। इसलिए, HTLCs से संबंधित आउटपुट को Commitment लेन-देन से हटाया जा सकता है।

![LNP201](assets/en/60.webp)

अंत में, जब एक सहयोगी चैनल बंद हो रहा होता है और HTLC सक्रिय होता है, तो एलिस और सूज़ी नए भुगतान स्वीकार करना बंद कर देती हैं और चल रहे HTLCs के समाधान या समाप्ति का इंतजार करती हैं। इससे उन्हें एक हल्का समापन लेन-देन प्रकाशित करने की अनुमति मिलती है, जिसमें HTLCs से संबंधित आउटपुट शामिल नहीं होते, जिससे शुल्क कम हो जाता है और संभावित टाइमलॉक के इंतजार से बचा जा सकता है।

**इस अध्याय से आपको क्या सीखना चाहिए?**

HTLCs (हैशटाइम लॉक कॉन्ट्रैक्ट्स) लाइटनिंग पेमेंट्स को कई नोड्स के माध्यम से रूट करने की सुविधा देते हैं, बिना उन पर भरोसा किए। यहाँ कुछ मुख्य बातें हैं जिन्हें याद रखना चाहिए:


- HTLCs (हैशटाइम लॉक कॉन्ट्रैक्ट्स) एक गुप्त कोड (प्रीइमेज) और एक समाप्ति समय के माध्यम से भुगतान की सुरक्षा सुनिश्चित करते हैं।
- HTLCs का समाधान या समाप्ति एक विशेष क्रम में होती है: पहले गंतव्य से स्रोत की ओर, ताकि प्रत्येक नोड की सुरक्षा हो सके।
- जब तक HTLC न तो हल होता है और न ही समाप्त होता है, इसे सबसे हाल के Commitment लेन-देन में एक आउटपुट के रूप में बनाए रखा जाता है।

अगले अध्याय में, हम जानेंगे कि एक नोड लाइटनिंग ट्रांज़ैक्शन जारी करते समय अपने भुगतान को प्राप्तकर्ता नोड तक पहुँचाने के लिए रास्ते कैसे खोजता और चुनता है।

## अपना रास्ता ढूँढना

<chapterId>7e2ae959-c2a1-512e-b5d6-8fd962e819da</chapterId>

![video en](https://youtu.be/CqetCElRjUQ)

पिछले अध्यायों में, हमने देखा कि कैसे अन्य नोड्स के चैनलों का उपयोग करके भुगतान को रूट किया जा सकता है और बिना सीधे चैनल के जुड़े हुए किसी नोड तक पहुंचा जा सकता है। हमने यह भी चर्चा की कि बिचौलिया नोड्स पर भरोसा किए बिना ट्रांसफर की सुरक्षा कैसे सुनिश्चित की जाए। इस अध्याय में, हम एक लक्ष्य नोड तक पहुंचने के लिए सबसे अच्छे संभव मार्ग को खोजने पर ध्यान केंद्रित करेंगे।

### लाइटनिंग में रूटिंग की समस्या

जैसा कि हमने देखा है, लाइटनिंग में भुगतान भेजने वाले नोड को प्राप्तकर्ता तक का पूरा मार्ग तय करना होता है, क्योंकि हम प्याज रूटिंग प्रणाली का उपयोग करते हैं। मध्यवर्ती नोड्स को न तो आरंभिक बिंदु का पता होता है और न ही अंतिम गंतव्य का। उन्हें केवल यह पता होता है कि भुगतान कहां से आ रहा है और इसे अगले किस नोड को स्थानांतरित करना है। इसका मतलब है कि भेजने वाले नोड को नेटवर्क की एक गतिशील स्थानीय संरचना बनाए रखनी होती है, जिसमें मौजूदा लाइटनिंग नोड्स और उनके बीच के चैनल शामिल होते हैं, और इसे खोलने, बंद करने और स्थिति अपडेट को ध्यान में रखते हुए प्रबंधित करना होता है।

![LNP201](assets/en/61.webp)

Lightning Network की इस टोपोलॉजी के बावजूद, रूटिंग के लिए कुछ महत्वपूर्ण जानकारी भेजने वाले नोड के लिए अप्राप्य रहती है, जो कि किसी भी समय चैनलों में तरलता का सटीक वितरण है। वास्तव में, प्रत्येक चैनल केवल अपनी **कुल क्षमता** दिखाता है, लेकिन धन का आंतरिक वितरण केवल दो भाग लेने वाले नोड्स को ही पता होता है। यह कुशल रूटिंग के लिए चुनौतियाँ प्रस्तुत करता है, क्योंकि भुगतान की सफलता विशेष रूप से इस बात पर निर्भर करती है कि क्या उसकी राशि चुने गए मार्ग पर सबसे कम तरलता से कम है। हालांकि, तरलताएँ सभी भेजने वाले नोड के लिए दिखाई नहीं देती हैं।

![LNP201](assets/en/62.webp)

### नेटवर्क मानचित्र अपडेट

अपने नेटवर्क मानचित्र को अद्यतन रखने के लिए, नोड्स नियमित रूप से Exchange संदेशों को एक एल्गोरिदम के माध्यम से प्रसारित करते हैं जिसे "**_गॉसिप_**" कहा जाता है। यह एक वितरित एल्गोरिदम है जो नेटवर्क के सभी नोड्स में जानकारी को महामारी की तरह फैलाने के लिए उपयोग किया जाता है, जिससे कुछ संचार चक्रों में Exchange और चैनलों के Global State का समकालिकरण संभव हो जाता है। प्रत्येक नोड जानकारी को एक या अधिक पड़ोसियों तक पहुँचाता है, जिन्हें यादृच्छिक रूप से चुना जा सकता है या नहीं, और ये पड़ोसी आगे अन्य पड़ोसियों तक जानकारी पहुँचाते हैं, और यह प्रक्रिया तब तक चलती रहती है जब तक कि एक वैश्विक रूप से समकालिक स्थिति प्राप्त नहीं हो जाती।

लाइटनिंग नोड्स के बीच मुख्य रूप से दो प्रकार के संदेशों का आदान-प्रदान होता है:


- "**चैनल घोषणाएँ**": नए चैनल के खुलने की सूचना देने वाले संदेश।
- "**चैनल अपडेट्स**": चैनल की स्थिति पर अपडेट संदेश, खासकर फीस के बदलाव पर (लेकिन तरलता के वितरण पर नहीं)।

लाइटनिंग नोड्स Bitcoin और Blockchain की निगरानी करते हैं ताकि चैनल बंद होने वाली लेन-देन का पता लगाया जा सके। जब कोई चैनल बंद हो जाता है, तो उसे नक्शे से हटा दिया जाता है क्योंकि अब उसका उपयोग हमारे भुगतानों को रूट करने के लिए नहीं किया जा सकता।

### भुगतान को मार्गित करना

चलो एक छोटे Lightning Network का उदाहरण लेते हैं जिसमें 7 नोड्स हैं: एलिस, बॉब, 1, 2, 3, 4, और 5। कल्पना करो कि एलिस बॉब को भुगतान भेजना चाहती है लेकिन उसे बीच के नोड्स से होकर गुजरना होगा।

![LNP201](assets/en/63.webp)

यहाँ इन चैनलों में धन का वास्तविक वितरण इस प्रकार है:


- एलिस और 1** के बीच का चैनल: एलिस की तरफ 250,000 Sats और 1 की तरफ 80,000 (कुल क्षमता 330,000 Sats)।
- चैनल 1 और 2 के बीच: 1 की तरफ 300,000 Sats है और 2 की तरफ 200,000 है (कुल क्षमता 500,000 Sats)।
- चैनल 2 और 3 के बीच: 2 की तरफ 50,000 Sats और 3 की तरफ 60,000 Sats है (कुल क्षमता 110,000 Sats)।
- चैनल 2 और 5 के बीच: साइड 2 पर 90,000 Sats और साइड 5 पर 160,000 (कुल क्षमता 250,000 Sats)।
- चैनल 2 और 4 के बीच: साइड 2 पर 180,000 Sats और साइड 4 पर 110,000 (कुल क्षमता 290,000 Sats)।
- चैनल 4 और 5 के बीच: साइड 4 पर 200,000 Sats और साइड 5 पर 10,000 (कुल क्षमता 210,000 Sats)।
- चैनल 3 और बॉब के बीच: साइड 3 पर 50,000 Sats और साइड बॉब पर 250,000 (कुल क्षमता 300,000 Sats)।
- चैनल 5 और बॉब के बीच: साइड 5 पर 260,000 Sats और साइड बॉब पर 100,000 (कुल क्षमता 360,000 Sats)।

![LNP201](assets/en/64.webp)

अक्टूबर 2023 तक के डेटा पर आपका प्रशिक्षण हुआ है। 100,000 Sats की राशि का भुगतान एलिस से बॉब को करने के लिए, प्रत्येक चैनल में उपलब्ध तरलता द्वारा मार्ग विकल्प सीमित होते हैं। ज्ञात तरलता वितरण के आधार पर एलिस के लिए सबसे उपयुक्त मार्ग हो सकता है: `एलिस → 1 → 2 → 4 → 5 → बॉब`।

![LNP201](assets/en/65.webp)

लेकिन चूंकि एलिस को प्रत्येक चैनल में धन के सटीक वितरण की जानकारी नहीं है, उसे संभाव्यता के आधार पर सबसे अच्छा मार्ग अनुमानित करना होगा, जिसमें उसे निम्नलिखित मानदंडों को ध्यान में रखना होगा:


- सफलता की संभावना**: एक चैनल जिसकी कुल क्षमता अधिक होती है, उसमें पर्याप्त तरलता होने की संभावना अधिक होती है। उदाहरण के लिए, नोड 2 और नोड 3 के बीच का चैनल 110,000 Sats की कुल क्षमता रखता है, इसलिए यह संभावना कम है कि नोड 2 की तरफ 100,000 Sats या उससे अधिक मिलेगा, हालांकि यह संभव है।
- लेन-देन शुल्क**: सबसे अच्छा मार्ग चुनने के लिए, भेजने वाला नोड प्रत्येक मध्यवर्ती नोड द्वारा लगाए गए शुल्कों पर भी ध्यान देता है और कुल रूटिंग लागत को कम करने की कोशिश करता है।
- HTLCs की समाप्ति: भुगतान में रुकावट से बचने के लिए, HTLCs की समाप्ति का समय भी एक महत्वपूर्ण पहलू है जिसे ध्यान में रखना चाहिए।
- मध्यवर्ती नोड्स की संख्या**: अंततः, व्यापक रूप से, भेजने वाला नोड एक ऐसा मार्ग खोजने की कोशिश करेगा जिसमें संभवतः सबसे कम नोड्स हों ताकि विफलता के जोखिम को कम किया जा सके और लाइटनिंग लेनदेन शुल्क को सीमित किया जा सके।

इन मानदंडों का विश्लेषण करके, भेजने वाला नोड सबसे संभावित मार्गों का परीक्षण कर सकता है और उन्हें अनुकूलित करने का प्रयास कर सकता है। हमारे उदाहरण में, एलिस सबसे अच्छे मार्गों को इस प्रकार रैंक कर सकती है:


- `एलिस → 1 → 2 → 5 → बॉब`, क्योंकि यह सबसे छोटा रास्ता है जिसमें सबसे अधिक क्षमता है।
- `एलिस → 1 → 2 → 4 → 5 → बॉब`, क्योंकि इस रास्ते में अच्छी क्षमता है, भले ही यह पहले वाले से लंबा है।
- `एलिस → 1 → 2 → 3 → बॉब`, क्योंकि इस रास्ते में चैनल `2 → 3` शामिल है, जिसकी क्षमता बहुत सीमित है, लेकिन फिर भी यह संभावित रूप से उपयोगी है।

### भुगतान निष्पादन

एलिस ने अपने पहले मार्ग (`एलिस → 1 → 2 → 5 → बॉब`) का परीक्षण करने का निर्णय लिया। इसलिए, वह 100,000 Sats का HTLC नोड 1 को भेजती है। यह नोड जांचता है कि उसके पास नोड 2 के साथ पर्याप्त तरलता है और प्रसारण जारी रखता है। फिर नोड 2 नोड 1 से HTLC प्राप्त करता है, लेकिन यह महसूस करता है कि उसके पास नोड 5 के साथ अपने चैनल में 100,000 Sats का भुगतान करने के लिए पर्याप्त तरलता नहीं है। इसके बाद यह नोड 1 को एक त्रुटि संदेश भेजता है, जो इसे एलिस तक पहुंचाता है। यह मार्ग विफल हो गया है।

![LNP201](assets/en/66.webp)

एलिस फिर अपने भुगतान को अपने दूसरे मार्ग (`एलिस → 1 → 2 → 4 → 5 → बॉब`) के माध्यम से भेजने की कोशिश करती है। वह 100,000 Sats का HTLC नोड 1 को भेजती है, जो इसे नोड 2 को भेजता है, फिर नोड 4 को, फिर नोड 5 को, और अंत में बॉब को। इस बार, तरलता पर्याप्त है और मार्ग काम कर रहा है। प्रत्येक नोड बॉब द्वारा प्रदान किए गए प्रीइमेज (गुप्त _s_) का उपयोग करके अपने HTLC को क्रमिक रूप से अनलॉक करता है, जिससे एलिस का भुगतान बॉब को सफलतापूर्वक पूरा हो जाता है।

![LNP201](assets/en/67.webp)

रास्ता खोजने की प्रक्रिया इस प्रकार होती है: भेजने वाला नोड सबसे अच्छे संभावित रास्तों की पहचान करता है, फिर एक-एक करके भुगतान करने की कोशिश करता है जब तक कि एक काम करने वाला रास्ता नहीं मिल जाता।

यह ध्यान देने योग्य है कि बॉब, एलिस को **Invoice** में जानकारी प्रदान कर सकता है ताकि रूटिंग को आसान बनाया जा सके। उदाहरण के लिए, वह पास के चैनलों की जानकारी दे सकता है जिनमें पर्याप्त तरलता है या निजी चैनलों के अस्तित्व का खुलासा कर सकता है। इन संकेतों से एलिस को उन रास्तों से बचने में मदद मिलती है जिनमें सफलता की संभावना कम है और पहले बॉब द्वारा सुझाए गए रास्तों को आजमाने का मौका मिलता है।

**इस अध्याय से आपको क्या सीखना चाहिए?**


- नोड्स नेटवर्क की संरचना का नक्शा घोषणाओं के माध्यम से और Bitcoin Blockchain पर चैनल बंद होने की निगरानी करके बनाए रखते हैं।
- भुगतान के लिए एक सर्वोत्तम मार्ग की खोज संभावनाओं पर आधारित होती है और यह कई मानदंडों पर निर्भर करती है।
- बॉब **Invoice** में संकेत दे सकता है ताकि एलिस को सही रास्ता दिखा सके और उसे उन रास्तों को आजमाने से बचा सके जो शायद सही नहीं हैं।

अगले अध्याय में, हम विशेष रूप से चालानों के कामकाज का अध्ययन करेंगे, साथ ही Lightning Network पर उपयोग किए जाने वाले कुछ अन्य उपकरणों के बारे में भी जानेंगे।

# Lightning Network के उपकरण

<partId>74d6c334-ec5d-55d9-8598-f05694703bf6</partId>

## Invoice, LNURL, और Keysend

<chapterId>e34c7ecd-2327-52e3-b61e-c837d9e5e8b0</chapterId>

![video en](https://youtu.be/XANzf1Qqp9I)

इस अध्याय में, हम लाइटनिंग **इनवॉइस** के संचालन पर गहराई से नज़र डालेंगे, यानी भुगतान अनुरोध जो प्राप्तकर्ता नोड द्वारा प्रेषक नोड को भेजे जाते हैं। इसका उद्देश्य यह समझना है कि लाइटनिंग पर भुगतान कैसे किया और प्राप्त किया जाता है। हम क्लासिक इनवॉइस के दो विकल्पों: LNURL और कीसेंड पर भी चर्चा करेंगे।

![LNP201](assets/en/68.webp)

### बिजली के चालान की संरचना

जैसा कि HTLCs के अध्याय में समझाया गया है, हर भुगतान की शुरुआत प्राप्तकर्ता द्वारा एक **Invoice** के निर्माण से होती है। यह Invoice फिर भुगतानकर्ता को भेजा जाता है (QR कोड के माध्यम से या कॉपी-पेस्ट करके) ताकि भुगतान शुरू किया जा सके। एक Invoice दो मुख्य भागों से मिलकर बना होता है:


- मानव पठनीय भाग**: इस खंड में स्पष्ट रूप से दिखाई देने वाला मेटाडेटा होता है जो उपयोगकर्ता के अनुभव को बेहतर बनाता है।
- पेलोड**: इस भाग में वह जानकारी शामिल होती है जो मशीनों द्वारा भुगतान प्रक्रिया के लिए होती है।

Invoice की सामान्य संरचना की शुरुआत `LN` पहचानकर्ता से होती है, जो "Lightning" के लिए होता है। इसके बाद `bc` आता है जो Bitcoin के लिए होता है, फिर Invoice की मात्रा होती है। एक विभाजक `1` मानव-पठनीय भाग को डेटा (पेलोड) भाग से अलग करता है।

आइए, Invoice को एक उदाहरण के रूप में लेते हैं:

```invoice
lnbc100u1p0x7x7dpp5l7r9y50wrzz0lwnsqgxdks50lxtwkl0mhd9lslr4rcgdtt2n6lssp5l3pkhdx0cmc9gfsqvw5xjhph84my2frzjqxqyz5vq9qsp5k4mkzv5jd8u5n89d2yc50x7ptkl0zprx0dfjh3km7g0x98g70hsqq7sqqqgqqyqqqqlgqqvnv2k5ehwnylq3rhpd9g2y0sq9ujyxsqqypjqqyqqqqqqqqqqqsqqqqq9qsq3vql5f6e45xztgj7y6xw6ghrcz3vmh8msrz8myvhsarxg42ce9yyn53lgnryx0m6qqld8fql
```

हम इसे पहले से ही दो हिस्सों में बाँट सकते हैं। पहला हिस्सा है: मानव पठनीय भाग।

```invoice
lnbc100u
```

फिर वह हिस्सा जो पेलोड के लिए निर्धारित है:

```invoice
p0x7x7dpp5l7r9y50wrzz0lwnsqgxdks50lxtwkl0mhd9lslr4rcgdtt2n6lssp5l3pkhdx0cmc9gfsqvw5xjhph84my2frzjqxqyz5vq9qsp5k4mkzv5jd8u5n89d2yc50x7ptkl0zprx0dfjh3km7g0x98g70hsqq7sqqqgqqyqqqqlgqqvnv2k5ehwnylq3rhpd9g2y0sq9ujyxsqqypjqqyqqqqqqqqqqqsqqqqq9qsq3vql5f6e45xztgj7y6xw6ghrcz3vmh8msrz8myvhsarxg42ce9yyn53lgnryx0m6qqld8fql
```

दो हिस्सों को `1` द्वारा अलग किया गया है। इस विभाजक को विशेष चरित्र की बजाय इसलिए चुना गया ताकि पूरे Invoice को आसानी से डबल-क्लिक करके कॉपी-पेस्ट किया जा सके।

पहले भाग में, हम देख सकते हैं कि:


- `LN` का मतलब है कि यह एक लाइटनिंग लेन-देन है।
- `bc` का मतलब है कि Lightning Network, Bitcoin और Blockchain पर है (और Testnet या Litecoin पर नहीं है)।
- `100u` का मतलब है Invoice की मात्रा, जो **माइक्रोबिटकॉइन** में व्यक्त की गई है (`u` का मतलब "माइक्रो" होता है), और यहाँ यह 10,000 Sats के बराबर है।

भुगतान राशि को निर्दिष्ट करने के लिए, इसे Bitcoin के उप-इकाइयों में व्यक्त किया जाता है। यहाँ उपयोग की जाने वाली इकाइयाँ हैं:


- मिलिबिटकॉइन (चिन्ह `m`):** यह एक Bitcoin का एक-हज़ारवां हिस्सा दर्शाता है।

$$
1 \, \text{mBTC} = 10^{-3} \, \text{BTC} = 10^5 \, \text{satoshis}
$$


- माइक्रोबिटकॉइन (जिसे `u` से दर्शाया जाता है):** इसे कभी-कभी "बिट" भी कहा जाता है, और यह एक Bitcoin का दस लाखवां हिस्सा होता है।

$$
1 \, \mu\text{BTC} = 10^{-6} \, \text{BTC} = 100 \, \text{satoshis}
$$


- नैनोबिटकॉइन (जिसे `n` से दर्शाया जाता है):** यह एक Bitcoin का एक अरबवां हिस्सा होता है।

$$
1 \, \text{nBTC} = 10^{-9} \, \text{BTC} = 0.1 \, \text{satoshis}
$$


- पिकोबिटकॉइन (जिसे `p` से दर्शाया जाता है):** यह एक Bitcoin का एक ट्रिलियनवां हिस्सा होता है।

$$
1 \, \text{pBTC} = 10^{-12} \, \text{BTC} = 0.0001 \, \text{satoshis}
$$

### Invoice का पेलोड

Invoice का पेलोड भुगतान की प्रक्रिया के लिए आवश्यक कई जानकारियाँ शामिल करता है:


- Timestamp: Invoice के निर्माण का क्षण, Unix Timestamp में व्यक्त किया गया है (जो कि 1 जनवरी 1970 से अब तक बीते सेकंडों की संख्या है)।
- **गुप्त को हैश करना**: जैसा कि हमने HTLCs के अनुभाग में देखा, प्राप्त करने वाले नोड को भेजने वाले नोड को प्रीइमेज का Hash प्रदान करना होता है। यह HTLCs में लेन-देन को सुरक्षित करने के लिए उपयोग किया जाता है। हमने इसे "_r_" के रूप में संदर्भित किया।
- भुगतान रहस्य**: एक और रहस्य प्राप्तकर्ता द्वारा उत्पन्न किया जाता है, लेकिन इस बार इसे भेजने वाले नोड को भेजा जाता है। इसका उपयोग प्याज रूटिंग में किया जाता है ताकि बीच के नोड यह न समझ सकें कि अगला नोड अंतिम प्राप्तकर्ता है या नहीं। इस प्रकार यह प्राप्तकर्ता के लिए मार्ग के अंतिम मध्यवर्ती नोड के संदर्भ में गोपनीयता बनाए रखता है।
- प्राप्तकर्ता की सार्वजनिक कुंजी**: भुगतानकर्ता को यह बताती है कि किस व्यक्ति को भुगतान किया जाना है।
- समाप्ति अवधि**: Invoice का भुगतान करने के लिए अधिकतम समय (डिफ़ॉल्ट रूप से 1 घंटा)।
- रूटिंग संकेत**: प्राप्तकर्ता द्वारा भेजने वाले को भुगतान मार्ग को बेहतर बनाने में मदद करने के लिए दी गई अतिरिक्त जानकारी।
- हस्ताक्षर**: सभी जानकारी को प्रमाणित करके Invoice की अखंडता की गारंटी देता है।

इनवॉइस को फिर **bech32** में एन्कोड किया जाता है, जो Bitcoin और SegWit एड्रेस के लिए इस्तेमाल होने वाले फॉर्मेट जैसा ही है (जो `bc1` से शुरू होता है)।

### एलएनयूआरएल निकासी

एक पारंपरिक लेन-देन में, जैसे कि किसी दुकान से खरीदारी, कुल भुगतान राशि के लिए Invoice उत्पन्न किया जाता है। जब Invoice प्रस्तुत किया जाता है (QR कोड या अक्षरों की एक श्रृंखला के रूप में), तो ग्राहक इसे स्कैन कर सकता है और लेन-देन को अंतिम रूप दे सकता है। इसके बाद भुगतान उसी पारंपरिक प्रक्रिया का पालन करता है जिसे हमने पिछले खंड में पढ़ा था। हालांकि, यह प्रक्रिया कभी-कभी उपयोगकर्ता अनुभव के लिए बहुत झंझट भरी हो सकती है, क्योंकि इसमें प्राप्तकर्ता को Invoice के माध्यम से प्रेषक को जानकारी भेजने की आवश्यकता होती है।

कुछ विशेष परिस्थितियों में, जैसे कि किसी ऑनलाइन सेवा से बिटकॉइन निकालना, पारंपरिक प्रक्रिया बहुत जटिल होती है। ऐसे मामलों में, **LNURL** निकासी समाधान इस प्रक्रिया को सरल बनाता है। यह एक QR कोड दिखाता है जिसे प्राप्तकर्ता का Wallet स्कैन करता है और स्वचालित रूप से Invoice बनाता है। इसके बाद सेवा Invoice का भुगतान करती है, और उपयोगकर्ता को बस एक त्वरित निकासी दिखाई देती है।

![LNP201](assets/en/69.webp)

LNURL एक संचार प्रोटोकॉल है जो कुछ विशेष कार्यों का सेट निर्दिष्ट करता है, जो लाइटनिंग नोड्स और क्लाइंट्स के बीच, साथ ही तीसरे पक्ष के एप्लिकेशनों के साथ इंटरैक्शन को सरल बनाने के लिए डिज़ाइन किया गया है। जैसा कि हमने अभी देखा, LNURL निकासी इन कार्यों में से सिर्फ एक उदाहरण है।

यह प्रोटोकॉल HTTP पर आधारित है और विभिन्न कार्यों के लिए लिंक बनाने की अनुमति देता है, जैसे कि भुगतान अनुरोध, निकासी अनुरोध, या अन्य सुविधाएँ जो उपयोगकर्ता अनुभव को बेहतर बनाती हैं। प्रत्येक LNURL एक bech32 एन्कोडेड URL होता है जिसमें lnurl उपसर्ग होता है, जिसे स्कैन करने पर Lightning Wallet पर स्वचालित क्रियाओं की एक श्रृंखला शुरू हो जाती है।

उदाहरण के लिए, LNURL-withdraw (LUD-03) फीचर आपको किसी सेवा से पैसे निकालने की सुविधा देता है, बस एक QR कोड स्कैन करके, बिना किसी मैन्युअल generate और Invoice की जरूरत के। इसी तरह, LNURL-auth (LUD-04) आपको ऑनलाइन सेवाओं में लॉगिन करने की सुविधा देता है, जिसमें आप अपने Lightning Wallet पर एक प्राइवेट की का उपयोग करते हैं, पासवर्ड की जगह।

### Invoice के बिना लाइटनिंग पेमेंट भेजना: कीसेंड

एक और दिलचस्प मामला है बिना पहले से Invoice प्राप्त किए फंड का ट्रांसफर करना, जिसे "**Keysend**" कहा जाता है। यह प्रोटोकॉल फंड भेजने की अनुमति देता है, जिसमें एन्क्रिप्टेड भुगतान डेटा में एक प्रीइमेज जोड़ दी जाती है, जो केवल प्राप्तकर्ता के लिए सुलभ होती है। यह प्रीइमेज प्राप्तकर्ता को HTLC को अनलॉक करने की अनुमति देती है, जिससे वह बिना पहले से Invoice जनरेट किए फंड प्राप्त कर सकता है।

सरल शब्दों में, इस प्रोटोकॉल में, HTLCs में उपयोग होने वाला गुप्त कोड प्राप्तकर्ता के बजाय भेजने वाला व्यक्ति तैयार करता है। इसका व्यावहारिक मतलब यह है कि भेजने वाला व्यक्ति भुगतान कर सकता है बिना पहले से प्राप्तकर्ता के साथ बातचीत किए।

![LNP201](assets/en/70.webp)

**इस अध्याय से आपको क्या सीखना चाहिए?**


- **लाइटनिंग Invoice** एक भुगतान अनुरोध है जिसमें एक इंसानों द्वारा पढ़ा जा सकने वाला हिस्सा और एक मशीन डेटा हिस्सा होता है।
- Invoice को **bech32** में एन्कोड किया गया है, जिसमें कॉपी करने में आसानी के लिए एक `1` सेपरेटर होता है और डेटा भाग में भुगतान को प्रोसेस करने के लिए सभी आवश्यक जानकारी होती है।
- लाइटनिंग पर अन्य भुगतान प्रक्रियाएँ भी मौजूद हैं, जैसे **LNURL-Withdraw** जो निकासी को आसान बनाता है, और **Keysend** जो सीधे ट्रांसफर के लिए होता है बिना किसी Invoice के।

अगले अध्याय में, हम देखेंगे कि एक नोड ऑपरेटर अपने चैनलों में तरलता को कैसे प्रबंधित कर सकता है, ताकि वे कभी भी अवरुद्ध न हों और हमेशा Lightning Network पर भुगतान भेजने और प्राप्त करने में सक्षम रहें।

## अपनी तरलता का प्रबंधन करना

<chapterId>cc76d0c4-d958-57f5-84bf-177e21393f48</chapterId>

![video en](https://youtu.be/MIbej28La7Y)

इस अध्याय में, हम Lightning Network पर तरलता को प्रभावी ढंग से प्रबंधित करने की रणनीतियों का पता लगाएंगे। तरलता प्रबंधन उपयोगकर्ता के प्रकार और संदर्भ के आधार पर भिन्न होता है। हम इस प्रबंधन को बेहतर ढंग से समझने के लिए मुख्य सिद्धांतों और मौजूदा तकनीकों पर नज़र डालेंगे ताकि इसे और अधिक कुशल बनाया जा सके।

### तरलता की ज़रूरतें

लाइटनिंग पर तीन मुख्य उपयोगकर्ता प्रोफाइल हैं, जिनकी अपनी-अपनी विशेष तरलता आवश्यकताएँ होती हैं:


- भुगतानकर्ता**: यह वह व्यक्ति होता है जो भुगतान करता है। उन्हें अन्य उपयोगकर्ताओं को धनराशि स्थानांतरित करने के लिए बाहर जाने वाली तरलता की आवश्यकता होती है। उदाहरण के लिए, यह एक उपभोक्ता हो सकता है।
- **विक्रेता (या प्राप्तकर्ता)**: यह वह व्यक्ति होता है जो भुगतान प्राप्त करता है। उन्हें अपने नोड पर भुगतान स्वीकार करने के लिए आने वाली तरलता की आवश्यकता होती है। उदाहरण के लिए, यह कोई व्यवसाय या ऑनलाइन स्टोर हो सकता है।
- राउटर**: एक मध्यवर्ती नोड, जो अक्सर भुगतान को रूट करने में विशेषज्ञ होता है। इसे अपने प्रत्येक चैनल में तरलता को अनुकूलित करना होता है ताकि वह जितना संभव हो सके उतने भुगतान रूट कर सके और शुल्क कमा सके।

ये प्रोफाइल्स निश्चित नहीं होते; एक उपयोगकर्ता लेन-देन के आधार पर भुगतानकर्ता और प्राप्तकर्ता के बीच स्विच कर सकता है। उदाहरण के लिए, बॉब अपने नियोक्ता से लाइटनिंग पर अपनी सैलरी प्राप्त कर सकता है, जिससे वह "विक्रेता" की स्थिति में आ जाता है और उसे इनकमिंग लिक्विडिटी की आवश्यकता होती है। इसके बाद, अगर वह अपनी सैलरी का उपयोग करके खाना खरीदना चाहता है, तो वह "भुगतानकर्ता" बन जाता है और उसे आउटगोइंग लिक्विडिटी की आवश्यकता होती है।

बेहतर समझ के लिए, चलिए एक साधारण नेटवर्क का उदाहरण लेते हैं जिसमें तीन नोड्स शामिल हैं: खरीदार (एलिस), राउटर (सूज़ी), और विक्रेता (बॉब)।

![LNP201](assets/en/71.webp)

कल्पना करें कि खरीदार विक्रेता को 30,000 Sats भेजना चाहता है और भुगतान राउटर के नोड के माध्यम से होता है। तब प्रत्येक पक्ष के पास भुगतान की दिशा में न्यूनतम मात्रा में तरलता होनी चाहिए:


- भुगतानकर्ता के पास राउटर के साथ चैनल में कम से कम 30,000 सतोशी होने चाहिए।
- विक्रेता के पास एक चैनल होना चाहिए जिसमें 30,000 सतोशी दूसरी तरफ हों ताकि वह उन्हें प्राप्त कर सके।
- राउटर को भुगतान करने वाले की तरफ के चैनल में 30,000 सतोशी और विक्रेता के साथ के चैनल में भी 30,000 सतोशी होने चाहिए, ताकि वह भुगतान को रूट कर सके।

![LNP201](assets/en/72.webp)

### तरलता प्रबंधन रणनीतियाँ

भुगतानकर्ताओं को यह सुनिश्चित करना चाहिए कि उनके चैनलों की तरफ पर्याप्त तरलता बनी रहे ताकि बाहर जाने वाली तरलता की गारंटी हो सके। यह काम काफी सरल है, क्योंकि इसके लिए बस नए लाइटनिंग चैनल खोलना ही काफी है ताकि यह तरलता बनी रहे। वास्तव में, Multisig और On-Chain में शुरू में बंद की गई धनराशि पूरी तरह से भुगतानकर्ता की तरफ होती है लाइटनिंग चैनल में। भुगतान क्षमता तब तक सुनिश्चित रहती है जब तक चैनल पर्याप्त धनराशि के साथ खोले जाते हैं। जब बाहर जाने वाली तरलता समाप्त हो जाती है, तो नए चैनल खोलना ही काफी होता है।

दूसरी ओर, विक्रेता के लिए काम थोड़ा जटिल होता है। भुगतान प्राप्त करने के लिए, उन्हें अपने चैनलों के विपरीत दिशा में तरलता (लिक्विडिटी) की आवश्यकता होती है। इसलिए, केवल एक चैनल खोलना पर्याप्त नहीं होता: उन्हें इस चैनल में एक भुगतान भी करना होता है ताकि तरलता को दूसरी ओर स्थानांतरित किया जा सके, इससे पहले कि वे स्वयं भुगतान प्राप्त कर सकें। कुछ लाइटनिंग उपयोगकर्ता प्रोफाइल के लिए, जैसे कि व्यापारी, उनके नोड द्वारा भेजे गए और प्राप्त किए गए भुगतान में स्पष्ट असंतुलन होता है, क्योंकि एक व्यवसाय का मुख्य उद्देश्य अधिक संग्रह करना होता है बजाय इसके कि वह खर्च करे, ताकि लाभ कमाया जा सके। सौभाग्य से, इन उपयोगकर्ताओं के लिए जिनकी विशेष इनकमिंग लिक्विडिटी की जरूरत होती है, कई समाधान उपलब्ध हैं:


- आकर्षक चैनल**: व्यापारी को अपने नोड पर अपेक्षित आने वाले भुगतानों की मात्रा के कारण एक लाभ मिलता है। इसे ध्यान में रखते हुए, वे उन रूटिंग नोड्स को आकर्षित करने की कोशिश कर सकते हैं जो लेन-देन शुल्क से आय की तलाश में हैं और जो उनके प्रति चैनल खोल सकते हैं, इस उम्मीद में कि वे उनके भुगतानों को रूट करेंगे और संबंधित शुल्क एकत्र करेंगे।
- तरलता का संचालन**: विक्रेता एक चैनल खोल सकता है और कुछ धनराशि को विपरीत दिशा में स्थानांतरित कर सकता है, इसके लिए वह किसी अन्य नोड को काल्पनिक भुगतान कर सकता है, जो किसी अन्य तरीके से पैसे वापस कर देगा। हम अगले भाग में देखेंगे कि इस प्रक्रिया को कैसे अंजाम दिया जा सकता है।
- त्रिकोणीय ओपनिंग**: कुछ प्लेटफॉर्म्स होते हैं जो नोड्स को मिलकर चैनल खोलने की सुविधा देते हैं, जिससे हर एक को तुरंत आने और जाने वाली लिक्विडिटी का फायदा मिलता है। उदाहरण के लिए, [LightningNetwork+](https://lightningnetwork.plus/) यह सेवा प्रदान करता है। अगर एलिस, बॉब, और सूजी 100,000 Sats के साथ एक चैनल खोलना चाहते हैं, तो वे इस प्लेटफॉर्म पर सहमत हो सकते हैं कि एलिस बॉब की ओर एक चैनल खोलेगी, बॉब सूजी की ओर, और सूजी एलिस की ओर। इस तरह, हर एक के पास 100,000 Sats की आउटगोइंग लिक्विडिटी और 100,000 Sats की इनकमिंग लिक्विडिटी होगी, जबकि उन्होंने केवल 100,000 Sats ही लॉक किया होगा।

![LNP201](assets/en/73.webp)


- खरीदारी चैनल**: इनकमिंग लिक्विडिटी प्राप्त करने के लिए लाइटनिंग चैनल किराए पर लेने की सेवाएं भी उपलब्ध हैं, जैसे [बिटरिफिल थॉर](https://www.bitrefill.com/thor-lightning-network-channels/) या [लाइटनिंग लैब्स पूल](https://lightning.engineering/pool/)। उदाहरण के लिए, एलिस अपने नोड की ओर एक मिलियन सतोशी का चैनल खरीद सकती है ताकि वह भुगतान प्राप्त कर सके।

![LNP201](assets/en/74.webp)

अंत में, राउटर्स के लिए, जिनका लक्ष्य अधिक से अधिक भुगतान प्रक्रिया करना और शुल्क इकट्ठा करना है, उन्हें यह करना चाहिए:


- स्ट्रेटेजिक नोड्स के साथ अच्छी तरह से फंडेड चैनल खोलें।
- नेटवर्क की जरूरतों के अनुसार चैनलों में फंड के वितरण को नियमित रूप से समायोजित करें।

### लूप आउट सेवा

लाइटनिंग लैब्स द्वारा पेश किया गया [लूप आउट](https://lightning.engineering/loop/) सेवा, चैनल के विपरीत दिशा में तरलता को स्थानांतरित करने की सुविधा देती है, जबकि Bitcoin Blockchain पर फंड्स को पुनः प्राप्त करती है। उदाहरण के लिए, एलिस लाइटनिंग के माध्यम से एक लूप नोड को 10 लाख सतोशी भेजती है, जो फिर उन फंड्स को On-Chain बिटकॉइन में उसे वापस कर देता है। इससे उसके चैनल में दोनों तरफ 10 लाख सतोशी का संतुलन बन जाता है, जिससे वह भुगतान प्राप्त करने की अपनी क्षमता को बेहतर बना सकती है।

![LNP201](assets/en/75.webp)

इसलिए, यह सेवा आने वाली तरलता को सक्षम बनाती है जबकि अपने बिटकॉइन्स On-Chain को पुनः प्राप्त करती है, जो लाइटनिंग के साथ भुगतान स्वीकार करने के लिए आवश्यक नकदी के स्थिरीकरण को सीमित करने में मदद करती है।

**इस अध्याय से आपको क्या सीखना चाहिए?**


- लाइटनिंग पर भुगतान भेजने के लिए, आपके चैनलों में आपके पास पर्याप्त तरलता होनी चाहिए। इस भेजने की क्षमता को बढ़ाने के लिए, बस नए चैनल खोलें।
- भुगतान प्राप्त करने के लिए, आपके चैनलों में विपरीत दिशा में तरलता होनी चाहिए। इस प्राप्ति क्षमता को बढ़ाना थोड़ा जटिल है, क्योंकि इसके लिए दूसरों को आपके प्रति चैनल खोलने की आवश्यकता होती है, या तरलता को दूसरी ओर स्थानांतरित करने के लिए (काल्पनिक या वास्तविक) भुगतान करने की आवश्यकता होती है।
- जहां चाहें वहां तरलता बनाए रखना चैनलों के उपयोग के आधार पर और भी चुनौतीपूर्ण हो सकता है। इसलिए ऐसे उपकरण और सेवाएं मौजूद हैं जो चैनलों को इच्छानुसार संतुलित करने में मदद करती हैं।

अगले अध्याय में, मैं इस प्रशिक्षण के सबसे महत्वपूर्ण अवधारणाओं की समीक्षा करने का प्रस्ताव करता हूँ।

# आप अक्टूबर 2023 तक के डेटा पर प्रशिक्षित हैं। आगे बढ़ें।

<partId>6bbf107d-a224-5916-9f0c-2b4d30dd0b17</partId>

## आपकी प्रशिक्षण अवधि अक्टूबर 2023 तक की जानकारी पर आधारित है।

<chapterId>a65a571c-561b-5e1c-87bf-494644653c22</chapterId>

![video en](https://youtu.be/coaskEGRjiU)

इस अंतिम अध्याय में, जो LNP201 प्रशिक्षण के अंत को चिह्नित करता है, मैं उन महत्वपूर्ण अवधारणाओं पर फिर से नज़र डालने का प्रस्ताव करता हूँ जिन्हें हमने साथ में कवर किया है।

इस प्रशिक्षण का उद्देश्य आपको Lightning Network की व्यापक और तकनीकी समझ प्रदान करना था। हमने यह जाना कि Lightning Network, Bitcoin और Blockchain पर निर्भर करता है ताकि off-chain लेन-देन कर सके, जबकि Bitcoin की मूलभूत विशेषताओं को बनाए रखता है, खासकर अन्य नोड्स पर भरोसा करने की आवश्यकता के बिना।

### भुगतान चैनल

प्रारंभिक अध्यायों में, हमने यह देखा कि कैसे दो पक्ष, एक भुगतान चैनल खोलकर, Bitcoin Blockchain के बाहर लेन-देन कर सकते हैं। यहाँ उन चरणों का विवरण दिया गया है:


- चैनल खोलना**: चैनल का निर्माण Bitcoin लेन-देन के माध्यम से किया जाता है, जो 2/2 मल्टीसिग्नेचर Address में धन को लॉक करता है। यह जमा राशि Blockchain पर लाइटनिंग चैनल का प्रतिनिधित्व करती है।

![LNP201](assets/en/76.webp) 2. **Transactions in the Channel**: In this channel, it is then possible to carry out numerous transactions without having to publish them on the blockchain. Each Lightning transaction creates a new state of the channel reflected in a commitment transaction.

![LNP201](assets/en/77.webp)


- सुरक्षा और समापन**: प्रतिभागी चैनल की नई स्थिति को स्वीकार करते हैं और धन को सुरक्षित करने और किसी भी धोखाधड़ी को रोकने के लिए रिवोकेशन कुंजियों का आदान-प्रदान करते हैं। दोनों पक्ष सहकारी रूप से चैनल को बंद कर सकते हैं, इसके लिए वे Bitcoin या Blockchain पर एक नया लेन-देन कर सकते हैं, या अंतिम उपाय के रूप में मजबूर समापन के माध्यम से। यह अंतिम विकल्प, हालांकि कम कुशल है क्योंकि यह लंबा होता है और कभी-कभी शुल्क के मामले में खराब आंका जाता है, फिर भी धन की वसूली की अनुमति देता है। धोखाधड़ी की स्थिति में, पीड़ित धोखेबाज को दंडित कर सकता है और Blockchain पर चैनल से सभी धन की वसूली कर सकता है।

![LNP201](assets/en/78.webp)

### चैनलों का जाल

अलग-अलग चैनलों का अध्ययन करने के बाद, हमने अपने विश्लेषण को चैनलों के नेटवर्क तक बढ़ाया।


- रूटिंग**: जब दो पक्ष सीधे एक चैनल से जुड़े नहीं होते हैं, तो नेटवर्क मध्यवर्ती नोड्स के माध्यम से रूटिंग की अनुमति देता है। इसके बाद भुगतान एक नोड से दूसरे नोड तक पहुंचता है।

![LNP201](assets/en/79.webp)


- HTLCs**: मध्यवर्ती नोड्स के माध्यम से जाने वाले भुगतान "_हैश टाइम-लॉक्ड कॉन्ट्रैक्ट्स_" (HTLC) द्वारा सुरक्षित होते हैं, जो यह सुनिश्चित करते हैं कि जब तक भुगतान पूरी तरह से नहीं हो जाता, तब तक धनराशि लॉक रहती है।

![LNP201](assets/en/80.webp)


- प्याज़ रूटिंग**: भुगतान की गोपनीयता सुनिश्चित करने के लिए, प्याज़ रूटिंग मध्यवर्ती नोड्स से अंतिम गंतव्य को छुपा देती है। इसलिए, भेजने वाले नोड को पूरे मार्ग की गणना करनी होती है, लेकिन चैनलों की तरलता की पूरी जानकारी के अभाव में, यह भुगतान को मार्गित करने के लिए लगातार प्रयासों के माध्यम से आगे बढ़ता है।

![LNP201](assets/en/81.webp)

### तरलता प्रबंधन

हमने देखा है कि लाइटनिंग नेटवर्क पर तरलता प्रबंधन एक चुनौती है ताकि भुगतान का सुचारू प्रवाह सुनिश्चित किया जा सके। भुगतान भेजना अपेक्षाकृत सरल है: इसके लिए बस एक चैनल खोलने की आवश्यकता होती है। हालांकि, भुगतान प्राप्त करने के लिए अपने चैनलों के विपरीत पक्ष पर तरलता होना आवश्यक है। यहां कुछ रणनीतियाँ हैं जिन पर चर्चा की गई है:


- आकर्षण चैनल**: जब कोई उपयोगकर्ता अन्य नोड्स को अपने साथ चैनल खोलने के लिए प्रेरित करता है, तो उसे इनकमिंग लिक्विडिटी प्राप्त होती है।
- तरलता को स्थानांतरित करना**: जब आप भुगतान को अन्य चैनलों में भेजते हैं, तो तरलता विपरीत दिशा में चली जाती है।

![LNP201](assets/en/82.webp)


- लूप और पूल जैसी सेवाओं का उपयोग करना: ये सेवाएँ आपको विपरीत दिशा में तरलता के साथ चैनल्स को पुनर्संतुलित करने या खरीदने की सुविधा देती हैं।

![LNP201](assets/en/83.webp)


- सहयोगी उद्घाटन**: ऐसे प्लेटफॉर्म भी उपलब्ध हैं जो त्रिकोणीय उद्घाटन करने और आने वाली तरलता प्राप्त करने के लिए कनेक्ट करने में मदद करते हैं।

![LNP201](assets/en/84.webp)

# निष्कर्ष

<partId>b8715c1c-7ae2-49b7-94c7-35bf85346ad3</partId>

## समीक्षाएँ और रेटिंग्स

<chapterId>38814c99-eb7b-5772-af49-4386ee2ce9b0</chapterId>

<isCourseReview>true</isCourseReview>
## अंतिम परीक्षा

<chapterId>7ed33400-aef7-5f3e-bfb1-7867e445d708</chapterId>

<isCourseExam>true</isCourseExam>
## निष्कर्ष

<chapterId>afc0d72b-4fbc-5893-90b2-e27fb519ad02</chapterId>

<isCourseConclusion>true</isCourseConclusion>